ТекстЗапроса = "ВЫБРАТЬ
               |	МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи,
               |	ИСТИНА КАК АктуальныйДокумент,
               |	DR_События.Документ КАК Документ
               |ПОМЕСТИТЬ ВтАктуальныйДокумент
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |ГДЕ
               |	(DR_События.ВидДокумента = ""СчетФактура_Исходящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPR_01_Исходящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Исходящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Исходящий"")
               |
               |СГРУППИРОВАТЬ ПО
               |	DR_События.Документ
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
               |	МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
               |ПОМЕСТИТЬ ВтАннулированияОтправленныеДата
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |ГДЕ
               |	DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий""
               |
               |СГРУППИРОВАТЬ ПО
               |	DR_События.ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования
               |
               |ИНДЕКСИРОВАТЬ ПО
               |	ИдентификаторЦепочки,
               |	ИдентификаторОснования
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
               |	МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
               |ПОМЕСТИТЬ ВтАннулированияПолученныеДата
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |ГДЕ
               |	DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий""
               |
               |СГРУППИРОВАТЬ ПО
               |	DR_События.ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования
               |
               |ИНДЕКСИРОВАТЬ ПО
               |	ИдентификаторЦепочки,
               |	ИдентификаторОснования
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ РАЗЛИЧНЫЕ
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Номер КАК Номер,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Дата КАК Дата,
               |	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
               |	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
               |	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
               |	DR_События.Документ КАК Документ,
               |	ВтАктуальныйДокумент.АктуальныйДокумент КАК АктуальныйДокумент,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование КАК ДокументОснование,
               |	ВЫБОР
               |		КОГДА НЕ ПолученныеUVUTOCH_24.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Отклонено аннулирование""
               |		КОГДА НЕ ОтправленныеUVUTOCH_24.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Отклонено аннулирование""
               |		КОГДА НЕ ПолученныеIZVPOL_23.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Принято аннулирование""
               |		КОГДА НЕ ОтправленныеIZVPOL_23.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Принято аннулирование""
               |		КОГДА НЕ АннулированияПолученные.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Предложено аннулирование""
               |		КОГДА НЕ АннулированияОтправленные.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Отправлено аннулирование""
               |		КОГДА НЕ ПолученныеUVUTOCH_09.ИдентификаторЦепочки ЕСТЬ NULL
               |				И НЕ ПолученныеPDOTPR_13.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Завершен с уточнением""
               |		КОГДА НЕ ПолученныеUVUTOCH_09.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Уточнение получено""
               |		КОГДА НЕ ПолученныеIZVPOL_06.Идентификатор ЕСТЬ NULL
               |				И DR_GLN.Контрагент_ФорматЭСФ В (""УПД Лента СЧФ"", ""УПД Метро"", ""УПД Зельгрос"", ""УПД Магнолия"", ""УПД ОКЕЙ"", ""УПД Спар"", ""УПД Дикси юг"", ""УПД Виктория"")
               |			ТОГДА ""Документооборот завершен""
               |		КОГДА НЕ ПолученныеПодписания.Идентификатор ЕСТЬ NULL
               |				И НЕ ОтправленныеIZVPOL_16.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Документооборот завершен""
               |		КОГДА НЕ ПолученныеПодписания.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""Подписано покупателем""
               |		КОГДА НЕ ПолученныеIZVPOL_06.Идентификатор ЕСТЬ NULL
               |				ИЛИ НЕ ПолученныеPDOTPR_08.ИдентификаторЦепочки ЕСТЬ NULL
               |			ТОГДА ""Ожидание подтверждения""
               |		КОГДА DR_События.ВидДокумента = ""СчетФактура_Исходящий""
               |			ТОГДА """"
               |		ИНАЧЕ ""Отправлен""
               |	КОНЕЦ КАК Статус_ЮЗД,
               |	DR_События.Статус КАК Статус,
               |	DR_События.Сообщение КАК Сообщение,
               |	DR_События.ВидДокумента КАК ВидДокумента,
               |	DR_События.Идентификатор КАК Идентификатор,
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).НомерИсправления КАК НомерИсправления,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен КАК Проведен,
               |	ВЫБОР
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование.ПометкаУдаления
               |			ТОГДА 2
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование.Проведен
               |			ТОГДА 1
               |		ИНАЧЕ 0
               |	КОНЕЦ КАК ДокументОснование__КартинкаСтатус,
               |	ВЫБОР
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ПометкаУдаления
               |			ТОГДА 2
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен
               |			ТОГДА 1
               |		ИНАЧЕ 0
               |	КОНЕЦ КАК Документ__КартинкаСтатус
               |ПОМЕСТИТЬ ВтОсновная
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВтАктуальныйДокумент КАК ВтАктуальныйДокумент
               |		ПО DR_События.Документ = ВтАктуальныйДокумент.Документ
               |			И DR_События.ДатаЗаписи = ВтАктуальныйДокумент.ДатаЗаписи
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
               |			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_GLN КАК DR_GLN
               |			ПО DR_ЦепочкиДокументов.Контрагент = DR_GLN.Объект
               |		ПО DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеIZVPOL_06
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеIZVPOL_06.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ПолученныеIZVPOL_06.ИдентификаторОснования
               |			И (ПолученныеIZVPOL_06.ВидДокумента = ""DP_IZVPOL_06_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеUVUTOCH_09
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеUVUTOCH_09.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ПолученныеUVUTOCH_09.ИдентификаторОснования
               |			И (ПолученныеUVUTOCH_09.ВидДокумента = ""DP_UVUTOCH_09_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВтАннулированияОтправленныеДата КАК ВтАннулированияОтправленныеДата
               |		ПО DR_События.ИдентификаторЦепочки = ВтАннулированияОтправленныеДата.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ВтАннулированияОтправленныеДата.ИдентификаторОснования
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК АннулированияОтправленные
               |		ПО DR_События.ИдентификаторЦепочки = АннулированияОтправленные.ИдентификаторЦепочки
               |			И (ВтАннулированияОтправленныеДата.ИдентификаторОснования = АннулированияОтправленные.ИдентификаторОснования)
               |			И (ВтАннулированияОтправленныеДата.ДатаЗаписи = АннулированияОтправленные.ДатаЗаписи)
               |			И (АннулированияОтправленные.ВидДокумента = ""DP_PRANNUL_22_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеIZVPOL_23
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеIZVPOL_23.ИдентификаторЦепочки
               |			И (АннулированияОтправленные.Идентификатор = ПолученныеIZVPOL_23.ИдентификаторОснования)
               |			И (ПолученныеIZVPOL_23.ВидДокумента = ""DP_IZVPOL_23_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеUVUTOCH_24
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеUVUTOCH_24.ИдентификаторЦепочки
               |			И (АннулированияОтправленные.Идентификатор = ПолученныеUVUTOCH_24.ИдентификаторОснования)
               |			И (ПолученныеUVUTOCH_24.ВидДокумента = ""DP_UVUTOCH_24_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеПодписания
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеПодписания.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ПолученныеПодписания.ИдентификаторОснования
               |			И (ПолученныеПодписания.ВидДокумента В (""ON_NSCHFDOPPOKMARK_11_Входящий"", ""ON_NSCHFDOPPOKPROS_11_Входящий"", ""ON_NSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOKMARK_11_Входящий"", ""ON_NKORSCHFDOPPOKPROS_11_Входящий""))
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеIZVPOL_16
               |		ПО DR_События.ИдентификаторЦепочки = ОтправленныеIZVPOL_16.ИдентификаторЦепочки
               |			И (ПолученныеПодписания.Идентификатор = ОтправленныеIZVPOL_16.ИдентификаторОснования)
               |			И (ОтправленныеIZVPOL_16.ВидДокумента = ""DP_IZVPOL_16_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВтАннулированияПолученныеДата КАК ВтАннулированияПолученныеДата
               |		ПО DR_События.ИдентификаторЦепочки = ВтАннулированияПолученныеДата.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ВтАннулированияПолученныеДата.ИдентификаторОснования
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК АннулированияПолученные
               |		ПО DR_События.ИдентификаторЦепочки = АннулированияПолученные.ИдентификаторЦепочки
               |			И (ВтАннулированияПолученныеДата.ИдентификаторОснования = АннулированияПолученные.ИдентификаторОснования)
               |			И (ВтАннулированияПолученныеДата.ДатаЗаписи = АннулированияПолученные.ДатаЗаписи)
               |			И (АннулированияПолученные.ВидДокумента = ""DP_PRANNUL_22_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеIZVPOL_23
               |		ПО DR_События.ИдентификаторЦепочки = ОтправленныеIZVPOL_23.ИдентификаторЦепочки
               |			И (АннулированияПолученные.Идентификатор = ОтправленныеIZVPOL_23.ИдентификаторОснования)
               |			И (ОтправленныеIZVPOL_23.ВидДокумента = ""DP_IZVPOL_23_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеUVUTOCH_24
               |		ПО DR_События.ИдентификаторЦепочки = ОтправленныеUVUTOCH_24.ИдентификаторЦепочки
               |			И (АннулированияПолученные.Идентификатор = ОтправленныеUVUTOCH_24.ИдентификаторОснования)
               |			И (ОтправленныеUVUTOCH_24.ВидДокумента = ""DP_UVUTOCH_24_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеPDOTPR_08
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеPDOTPR_08.ИдентификаторЦепочки
               |			И (ПолученныеIZVPOL_06.Идентификатор = ПолученныеPDOTPR_08.ИдентификаторОснования)
               |			И (ПолученныеPDOTPR_08.ВидДокумента = ""DP_PDOTPR_08"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеPDOTPR_13
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеPDOTPR_13.ИдентификаторЦепочки
               |			И (ПолученныеUVUTOCH_09.Идентификатор = ПолученныеPDOTPR_13.ИдентификаторОснования)
               |			И (ПолученныеPDOTPR_13.ВидДокумента = ""DP_PDOTPR_13"")
               |ГДЕ
               |	(DR_События.ВидДокумента = ""СчетФактура_Исходящий""
               |				И ВтАктуальныйДокумент.АктуальныйДокумент
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPR_01_Исходящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Исходящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Исходящий"")
               |	И НЕ ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Корректировочный
               |	И НЕ ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Исправление
               |
               |ИНДЕКСИРОВАТЬ ПО
               |	ИдентификаторЦепочки,
               |	Идентификатор
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	ВтОсновная.Номер КАК Номер,
               |	ВтОсновная.Дата КАК Дата,
               |	ВтОсновная.ДатаЗаказа КАК ДатаЗаказа,
               |	ВтОсновная.НомерЗаказа КАК НомерЗаказа,
               |	ВтОсновная.ДатаПоставки КАК ДатаПоставки,
               |	ВтОсновная.Документ КАК Документ,
               |	ВтОсновная.АктуальныйДокумент КАК АктуальныйДокумент,
               |	ВтОсновная.ДокументОснование КАК ДокументОснование,
               |	ВтОсновная.Статус_ЮЗД КАК Статус_ЮЗД,
               |	ВтОсновная.Статус КАК Статус,
               |	ВтОсновная.Сообщение КАК Сообщение,
               |	ВтОсновная.ВидДокумента КАК ВидДокумента,
               |	ВтОсновная.НомерИсправления КАК НомерИсправления,
               |	ВтОсновная.Проведен КАК Проведен,
               |	ВтОсновная.ДокументОснование__КартинкаСтатус КАК ДокументОснование__КартинкаСтатус,
               |	ВтОсновная.Документ__КартинкаСтатус КАК Документ__КартинкаСтатус,
               |	ВтОсновная.Идентификатор КАК Идентификатор,
               |	ВтОсновная.ИдентификаторЦепочки КАК ИдентификаторЦепочки
               |ИЗ
               |	ВтОсновная КАК ВтОсновная";