ТекстЗапроса = "ВЫБРАТЬ
               |	DR_События.Документ КАК Документ,
               |	ВЫБОР
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ПометкаУдаления
               |			ТОГДА 2
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен
               |			ТОГДА 1
               |		ИНАЧЕ 0
               |	КОНЕЦ КАК Документ__КартинкаСтатус,
               |	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
               |	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
               |	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
               |	DR_События.ВидДокумента КАК ВидДокумента,
               |	ВложенныйЗапрос_03.DP_PDOTPR_03 КАК DP_PDOTPR_03,
               |	ВложенныйЗапрос_06_Исходящий.DP_IZVPOL_06_Исходящий КАК DP_IZVPOL_06_Исходящий,
               |	ВложенныйЗапрос_07.DP_PDPOL_07 КАК DP_PDPOL_07,
               |	ВложенныйЗапрос_08.DP_PDOTPR_08 КАК DP_PDOTPR_08,
               |	ВложенныйЗапрос_09_Исходящий.DP_UVUTOCH_09_Исходящий КАК DP_UVUTOCH_09_Исходящий,
               |	ВложенныйЗапрос_11.ON_11 КАК ON_11,
               |	ВложенныйЗапрос_13.DP_PDOTPR_13 КАК DP_PDOTPR_13,
               |	ВложенныйЗапрос_22_Входящий.DP_PRANNUL_22_Входящий КАК DP_PRANNUL_22_Входящий,
               |	ВложенныйЗапрос_22_Исходящий.DP_PRANNUL_22_Исходящий КАК DP_PRANNUL_22_Исходящий,
               |	ВложенныйЗапрос_23_Входящий.DP_IZVPOL_23_Входящий КАК DP_IZVPOL_23_Входящий,
               |	ВложенныйЗапрос_23_Исходящий.DP_IZVPOL_23_Исходящий КАК DP_IZVPOL_23_Исходящий,
               |	ВложенныйЗапрос_24_Входящий.DP_UVUTOCH_24_Входящий КАК DP_UVUTOCH_24_Входящий,
               |	ВложенныйЗапрос_24_Исходящий.DP_UVUTOCH_24_Исходящий КАК DP_UVUTOCH_24_Исходящий,
               |	DR_События.Идентификатор КАК Идентификатор,
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
               |		ПО (DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			DR_События.ВидДокумента = ""DP_PDOTPR_03_Входящий"" КАК DP_PDOTPR_03,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_PDOTPR_03_Входящий"") КАК ВложенныйЗапрос_03
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_03.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_03.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			DR_События.ВидДокумента = ""DP_IZVPOL_06_Исходящий"" КАК DP_IZVPOL_06_Исходящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
               |			DR_События.Идентификатор КАК Идентификатор
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_IZVPOL_06_Исходящий"") КАК ВложенныйЗапрос_06_Исходящий
               |			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |				DR_События.ВидДокумента = ""DP_PDOTPR_08"" КАК DP_PDOTPR_08,
               |				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |			ИЗ
               |				РегистрСведений.DR_События КАК DR_События
               |			ГДЕ
               |				DR_События.ВидДокумента = ""DP_PDOTPR_08"") КАК ВложенныйЗапрос_08
               |			ПО (ВложенныйЗапрос_06_Исходящий.ИдентификаторЦепочки = ВложенныйЗапрос_08.ИдентификаторЦепочки)
               |				И (ВложенныйЗапрос_06_Исходящий.Идентификатор = ВложенныйЗапрос_08.ИдентификаторОснования)
               |			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |				DR_События.ВидДокумента = ""DP_PDPOL_07"" КАК DP_PDPOL_07,
               |				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |			ИЗ
               |				РегистрСведений.DR_События КАК DR_События
               |			ГДЕ
               |				DR_События.ВидДокумента = ""DP_PDPOL_07"") КАК ВложенныйЗапрос_07
               |			ПО (ВложенныйЗапрос_06_Исходящий.ИдентификаторЦепочки = ВложенныйЗапрос_07.ИдентификаторЦепочки)
               |				И (ВложенныйЗапрос_06_Исходящий.Идентификатор = ВложенныйЗапрос_07.ИдентификаторОснования)
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_06_Исходящий.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_06_Исходящий.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			DR_События.ВидДокумента = ""DP_UVUTOCH_09_Исходящий"" КАК DP_UVUTOCH_09_Исходящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_UVUTOCH_09_Исходящий"") КАК ВложенныйЗапрос_09_Исходящий
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_09_Исходящий.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_09_Исходящий.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			ИСТИНА КАК ON_11,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента В (""ON_NSCHFDOPPOKMARK_11_Исходящий"", ""ON_NSCHFDOPPOKPROS_11_Исходящий"", ""ON_NSCHFDOPPOK_11_Исходящий"", ""ON_NKORSCHFDOPPOK_11_Исходящий"", ""ON_NKORSCHFDOPPOKMARK_11_Исходящий"", ""ON_NKORSCHFDOPPOKPROS_11_Исходящий"")) КАК ВложенныйЗапрос_11
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_11.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_11.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			DR_События.ВидДокумента = ""DP_PDOTPR_13"" КАК DP_PDOTPR_13,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_PDOTPR_13"") КАК ВложенныйЗапрос_13
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_13.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_13.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			МАКСИМУМ(DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий"") КАК DP_PRANNUL_22_Входящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
               |			DR_События.Идентификатор КАК Идентификатор
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий""
               |		
               |		СГРУППИРОВАТЬ ПО
               |			DR_События.ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования,
               |			DR_События.Идентификатор) КАК ВложенныйЗапрос_22_Входящий
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_22_Входящий.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_22_Входящий.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			МАКСИМУМ(DR_События.ВидДокумента = ""DP_UVUTOCH_24_Исходящий"") КАК DP_UVUTOCH_24_Исходящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_UVUTOCH_24_Исходящий""
               |		
               |		СГРУППИРОВАТЬ ПО
               |			DR_События.ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_24_Исходящий
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_24_Исходящий.ИдентификаторЦепочки)
               |			И (DR_События.ИдентификаторОснования = ВложенныйЗапрос_24_Исходящий.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			МАКСИМУМ(DR_События.ВидДокумента = ""DP_IZVPOL_23_Входящий"") КАК DP_IZVPOL_23_Входящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_IZVPOL_23_Входящий""
               |		
               |		СГРУППИРОВАТЬ ПО
               |			DR_События.ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_23_Входящий
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_23_Входящий.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_23_Входящий.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			МАКСИМУМ(DR_События.ВидДокумента = ""DP_IZVPOL_23_Исходящий"") КАК DP_IZVPOL_23_Исходящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_IZVPOL_23_Исходящий""
               |		
               |		СГРУППИРОВАТЬ ПО
               |			DR_События.ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_23_Исходящий
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_23_Исходящий.ИдентификаторЦепочки)
               |			И (DR_События.ИдентификаторОснования = ВложенныйЗапрос_23_Исходящий.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			МАКСИМУМ(DR_События.ВидДокумента = ""DP_UVUTOCH_24_Входящий"") КАК DP_UVUTOCH_24_Входящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_UVUTOCH_24_Входящий""
               |		
               |		СГРУППИРОВАТЬ ПО
               |			DR_События.ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_24_Входящий
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_24_Входящий.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_24_Входящий.ИдентификаторОснования)
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			МАКСИМУМ(DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий"") КАК DP_PRANNUL_22_Исходящий,
               |			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
               |			DR_События.Идентификатор КАК Идентификатор
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий""
               |		
               |		СГРУППИРОВАТЬ ПО
               |			DR_События.ИдентификаторЦепочки,
               |			DR_События.ИдентификаторОснования,
               |			DR_События.Идентификатор) КАК ВложенныйЗапрос_22_Исходящий
               |		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_22_Исходящий.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ВложенныйЗапрос_22_Исходящий.ИдентификаторОснования)
               |ГДЕ
               |	(DR_События.ВидДокумента = ""ON_NSCHFDOPPR_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRPROS_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Испр_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Испр_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Испр_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Испр_Входящий"")";