ТекстЗапроса =  
"ВЫБРАТЬ
|	DR_События.Документ КАК Документ,
|	ВЫБОР
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ПометкаУдаления
|			ТОГДА 2
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен
|			ТОГДА 1
|		ИНАЧЕ 0
|	КОНЕЦ КАК Документ__КартинкаСтатус,
|	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
|	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
|	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
|	DR_События.ВидДокумента КАК ВидДокумента,
|	ВложенныйЗапрос_06_Входящий.DP_IZVPOL_06_Входящий КАК DP_IZVPOL_06_Входящий,
|	ВложенныйЗапрос_09.DP_UVUTOCH_09_Входящий КАК DP_UVUTOCH_09_Входящий,
|	ВложенныйЗапрос_11.ON_11 КАК ON_11,
|	ВложенныйЗапрос_16.DP_PDOTPR_16 КАК DP_PDOTPR_16,
|	ВложенныйЗапрос_22_Входящий.DP_PRANNUL_22_Входящий КАК DP_PRANNUL_22_Входящий,
|	ВложенныйЗапрос_22_Исходящий.DP_PRANNUL_22_Исходящий КАК DP_PRANNUL_22_Исходящий,
|	ВложенныйЗапрос_23_Входящий.DP_IZVPOL_23_Входящий КАК DP_IZVPOL_23_Входящий,
|	ВложенныйЗапрос_23_Исходящий.DP_IZVPOL_23_Исходящий КАК DP_IZVPOL_23_Исходящий,
|	ВложенныйЗапрос_24_Входящий.DP_UVUTOCH_24_Входящий КАК DP_UVUTOCH_24_Входящий,
|	ВложенныйЗапрос_24_Исходящий.DP_UVUTOCH_24_Исходящий КАК DP_UVUTOCH_24_Исходящий,
|	DR_События.Идентификатор КАК Идентификатор,
|	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|	DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|ИЗ
|	РегистрСведений.DR_События КАК DR_События
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
|		ПО (DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			DR_События.ВидДокумента = ""DP_IZVPOL_06_Входящий"" КАК DP_IZVPOL_06_Входящий,
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_IZVPOL_06_Входящий"") КАК ВложенныйЗапрос_06_Входящий
|		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_06_Входящий.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = ВложенныйЗапрос_06_Входящий.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			ИСТИНА КАК ON_11,
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента В (""ON_NSCHFDOPPOKMARK_11_Входящий"", ""ON_NSCHFDOPPOKPROS_11_Входящий"", ""ON_NSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOKMARK_11_Входящий"", ""ON_NKORSCHFDOPPOKPROS_11_Входящий"")) КАК ВложенныйЗапрос_11
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ВидДокумента = ""DP_IZVPOL_16_Исходящий"" КАК DP_PDOTPR_16,
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_IZVPOL_16_Исходящий"") КАК ВложенныйЗапрос_16
|			ПО (ВложенныйЗапрос_11.ИдентификаторЦепочки = ВложенныйЗапрос_16.ИдентификаторЦепочки)
|				И (ВложенныйЗапрос_16.ИдентификаторОснования ПОДОБНО ""%"" + ВложенныйЗапрос_11.Идентификатор)
|		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_11.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = ВложенныйЗапрос_11.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			МАКСИМУМ(DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий"") КАК DP_PRANNUL_22_Входящий,
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий""
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования,
|			DR_События.Идентификатор) КАК ВложенныйЗапрос_22_Входящий
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				МАКСИМУМ(DR_События.ВидДокумента = ""DP_IZVPOL_23_Исходящий"") КАК DP_IZVPOL_23_Исходящий,
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_IZVPOL_23_Исходящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_23_Исходящий
|			ПО (ВложенныйЗапрос_22_Входящий.ИдентификаторЦепочки = ВложенныйЗапрос_23_Исходящий.ИдентификаторЦепочки)
|				И (ВложенныйЗапрос_22_Входящий.Идентификатор = ВложенныйЗапрос_23_Исходящий.ИдентификаторОснования)
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				МАКСИМУМ(DR_События.ВидДокумента = ""DP_UVUTOCH_24_Исходящий"") КАК DP_UVUTOCH_24_Исходящий,
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_UVUTOCH_24_Исходящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_24_Исходящий
|			ПО (ВложенныйЗапрос_22_Входящий.ИдентификаторЦепочки = ВложенныйЗапрос_24_Исходящий.ИдентификаторЦепочки)
|				И (ВложенныйЗапрос_22_Входящий.Идентификатор = ВложенныйЗапрос_24_Исходящий.ИдентификаторОснования)
|		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_22_Входящий.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = ВложенныйЗапрос_22_Входящий.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			МАКСИМУМ(DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий"") КАК DP_PRANNUL_22_Исходящий,
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий""
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования,
|			DR_События.Идентификатор) КАК ВложенныйЗапрос_22_Исходящий
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				МАКСИМУМ(DR_События.ВидДокумента = ""DP_UVUTOCH_24_Входящий"") КАК DP_UVUTOCH_24_Входящий,
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_UVUTOCH_24_Входящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_24_Входящий
|			ПО (ВложенныйЗапрос_22_Исходящий.ИдентификаторЦепочки = ВложенныйЗапрос_24_Входящий.ИдентификаторЦепочки)
|				И (ВложенныйЗапрос_22_Исходящий.Идентификатор = ВложенныйЗапрос_24_Входящий.ИдентификаторОснования)
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				МАКСИМУМ(DR_События.ВидДокумента = ""DP_IZVPOL_23_Входящий"") КАК DP_IZVPOL_23_Входящий,
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_IZVPOL_23_Входящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ВложенныйЗапрос_23_Входящий
|			ПО (ВложенныйЗапрос_22_Исходящий.ИдентификаторЦепочки = ВложенныйЗапрос_23_Входящий.ИдентификаторЦепочки)
|				И (ВложенныйЗапрос_22_Исходящий.Идентификатор = ВложенныйЗапрос_23_Входящий.ИдентификаторОснования)
|		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_22_Исходящий.ИдентификаторЦепочки)
|			И (DR_События.ИдентификаторОснования = ВложенныйЗапрос_22_Исходящий.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			DR_События.ВидДокумента = ""DP_UVUTOCH_09_Входящий"" КАК DP_UVUTOCH_09_Входящий,
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_UVUTOCH_09_Входящий"") КАК ВложенныйЗапрос_09
|		ПО (DR_События.ИдентификаторЦепочки = ВложенныйЗапрос_09.ИдентификаторЦепочки
|				И DR_События.Идентификатор = ВложенныйЗапрос_09.ИдентификаторОснования)
|ГДЕ
|	(DR_События.ВидДокумента = ""ON_NSCHFDOPPR_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRPROS_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Испр_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Испр_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Испр_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Испр_Исходящий"")";