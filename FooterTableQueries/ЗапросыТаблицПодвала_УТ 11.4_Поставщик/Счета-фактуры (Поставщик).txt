ТекстЗапроса =  
"ВЫБРАТЬ
|	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Номер КАК Номер,
|	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Дата КАК Дата,
|	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
|	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
|	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
|	DR_События.Документ КАК Документ,
|	ВложенныйЗапрос.АктуальныйДокумент КАК АктуальныйДокумент,
|	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование КАК ДокументОснование,
|	ВЫБОР
|		КОГДА НЕ ПолученныеUVUTOCH_24.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Отклонено аннулирование""
|		КОГДА НЕ ОтправленныеUVUTOCH_24.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Отклонено аннулирование""
|		КОГДА НЕ ПолученныеIZVPOL_23.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Принято аннулирование""
|		КОГДА НЕ ОтправленныеIZVPOL_23.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Принято аннулирование""
|		КОГДА НЕ АннулированияПолученные.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Предложено аннулирование""
|		КОГДА НЕ АннулированияОтправленные.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Отправлено аннулирование""
|		КОГДА НЕ ПолученныеUVUTOCH_09.ИдентификаторЦепочки ЕСТЬ NULL
|				И НЕ ПолученныеPDOTPR_13.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Завершен с уточнением""
|		КОГДА НЕ ПолученныеUVUTOCH_09.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Уточнение получено""
|		КОГДА НЕ ПолученныеIZVPOL_06.Идентификатор ЕСТЬ NULL
|				И ЭКОМ_GLN.Контрагент_ФорматЭСФ В (""УПД Лента СЧФ"", ""УПД Метро"", ""УПД Зельгрос"", ""УПД Магнолия"", ""УПД ОКЕЙ"", ""УПД Спар"", ""УПД Дикси юг"", ""УПД Виктория"")
|			ТОГДА ""Документооборот завершен""
|		КОГДА НЕ ПолученныеПодписания.Идентификатор ЕСТЬ NULL
|				И НЕ ОтправленныеIZVPOL_16.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Документооборот завершен""
|		КОГДА НЕ ПолученныеПодписания.Идентификатор ЕСТЬ NULL
|			ТОГДА ""Подписано покупателем""
|		КОГДА НЕ ПолученныеIZVPOL_06.Идентификатор ЕСТЬ NULL
|				ИЛИ НЕ ПолученныеPDOTPR_08.ИдентификаторЦепочки ЕСТЬ NULL
|			ТОГДА ""Ожидание подтверждения""
|		КОГДА DR_События.ВидДокумента = ""СчетФактура_Исходящий""
|			ТОГДА """"
|		ИНАЧЕ ""Отправлен""
|	КОНЕЦ КАК Статус_ЮЗД,
|	DR_События.Статус КАК статус,
|	DR_События.Сообщение КАК Сообщение,
|	DR_События.ВидДокумента КАК ВидДокумента,
|	DR_События.Идентификатор КАК Идентификатор,
|	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).НомерИсправления КАК НомерИсправления,
|	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен КАК Проведен,
|	ВЫБОР
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование.ПометкаУдаления
|			ТОГДА 2
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование.Проведен
|			ТОГДА 1
|		ИНАЧЕ 0
|	КОНЕЦ КАК ДокументОснование__КартинкаСтатус,
|	ВЫБОР
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ПометкаУдаления
|			ТОГДА 2
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен
|			ТОГДА 1
|		ИНАЧЕ 0
|	КОНЕЦ КАК Документ__КартинкаСтатус
|ИЗ
|	РегистрСведений.DR_События КАК DR_События
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи,
|			DR_События.Документ КАК Документ,
|			ИСТИНА КАК АктуальныйДокумент
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			(DR_События.ВидДокумента = ""СчетФактура_Исходящий""
|					ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPR_01_Исходящий""
|					ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Исходящий""
|					ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Исходящий"")
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.Документ) КАК ВложенныйЗапрос
|		ПО (DR_События.Документ = ВложенныйЗапрос.Документ)
|			И (DR_События.ДатаЗаписи = ВложенныйЗапрос.ДатаЗаписи)
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
|			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_GLN КАК ЭКОМ_GLN
|			ПО (DR_ЦепочкиДокументов.Контрагент = ЭКОМ_GLN.Объект)
|		ПО (DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			ПоследнееАннулирование.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			(ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|				МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ПоследнееАннулирование
|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК DR_События
|				ПО ПоследнееАннулирование.ИдентификаторЦепочки = DR_События.ИдентификаторЦепочки
|					И (DR_События.ИдентификаторОснования = ПоследнееАннулирование.ИдентификаторОснования)
|					И (DR_События.ДатаЗаписи = ПоследнееАннулирование.ДатаЗаписи)
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий""
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.ИдентификаторОснования,
|			DR_События.Идентификатор,
|			ПоследнееАннулирование.ИдентификаторЦепочки) КАК АннулированияОтправленные
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_IZVPOL_23_Входящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ПолученныеIZVPOL_23
|			ПО (АннулированияОтправленные.ИдентификаторЦепочки = ПолученныеIZVPOL_23.ИдентификаторЦепочки)
|				И (АннулированияОтправленные.Идентификатор = ПолученныеIZVPOL_23.ИдентификаторОснования)
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_UVUTOCH_24_Входящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ПолученныеUVUTOCH_24
|			ПО (АннулированияОтправленные.ИдентификаторЦепочки = ПолученныеUVUTOCH_24.ИдентификаторЦепочки)
|				И (АннулированияОтправленные.Идентификатор = ПолученныеUVUTOCH_24.ИдентификаторОснования)
|		ПО (DR_События.ИдентификаторЦепочки = АннулированияОтправленные.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = АннулированияОтправленные.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			(ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|				МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ПоследнееАннулирование
|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК DR_События
|				ПО ПоследнееАннулирование.ИдентификаторЦепочки = DR_События.ИдентификаторЦепочки
|					И ПоследнееАннулирование.ИдентификаторОснования = DR_События.ИдентификаторОснования
|					И (DR_События.ДатаЗаписи = ПоследнееАннулирование.ДатаЗаписи)
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий""
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования,
|			DR_События.Идентификатор) КАК АннулированияПолученные
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_IZVPOL_23_Исходящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ОтправленныеIZVPOL_23
|			ПО (АннулированияПолученные.ИдентификаторЦепочки = ОтправленныеIZVPOL_23.ИдентификаторЦепочки)
|				И (ОтправленныеIZVPOL_23.ИдентификаторОснования ПОДОБНО ""%"" + АннулированияПолученные.Идентификатор)
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_UVUTOCH_24_Исходящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ОтправленныеUVUTOCH_24
|			ПО (АннулированияПолученные.ИдентификаторЦепочки = ОтправленныеUVUTOCH_24.ИдентификаторЦепочки)
|				И (АннулированияПолученные.Идентификатор = ОтправленныеUVUTOCH_24.ИдентификаторОснования)
|		ПО (DR_События.ИдентификаторЦепочки = АннулированияПолученные.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = АннулированияПолученные.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента В (""ON_NSCHFDOPPOKMARK_11_Входящий"", ""ON_NSCHFDOPPOKPROS_11_Входящий"", ""ON_NSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOKMARK_11_Входящий"", ""ON_NKORSCHFDOPPOKPROS_11_Входящий"")
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования,
|			DR_События.Идентификатор) КАК ПолученныеПодписания
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_IZVPOL_16_Исходящий""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ОтправленныеIZVPOL_16
|			ПО (ПолученныеПодписания.ИдентификаторЦепочки = ОтправленныеIZVPOL_16.ИдентификаторЦепочки)
|				И (ОтправленныеIZVPOL_16.ИдентификаторОснования ПОДОБНО ""%"" + ПолученныеПодписания.Идентификатор)
|		ПО (DR_События.ИдентификаторЦепочки = ПолученныеПодписания.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = ПолученныеПодписания.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_IZVPOL_06_Входящий""
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования,
|			DR_События.Идентификатор) КАК ПолученныеIZVPOL_06
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_PDOTPR_08""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ПолученныеPDOTPR_08
|			ПО (ПолученныеIZVPOL_06.ИдентификаторЦепочки = ПолученныеPDOTPR_08.ИдентификаторЦепочки)
|				И (ПолученныеPDOTPR_08.ИдентификаторОснования ПОДОБНО ""%"" + ПолученныеIZVPOL_06.Идентификатор)
|		ПО (DR_События.ИдентификаторЦепочки = ПолученныеIZVPOL_06.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = ПолученныеIZVPOL_06.ИдентификаторОснования)
|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|			DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|			DR_События.Идентификатор КАК Идентификатор
|		ИЗ
|			РегистрСведений.DR_События КАК DR_События
|		ГДЕ
|			DR_События.ВидДокумента = ""DP_UVUTOCH_09_Входящий""
|		
|		СГРУППИРОВАТЬ ПО
|			DR_События.ИдентификаторЦепочки,
|			DR_События.ИдентификаторОснования,
|			DR_События.Идентификатор) КАК ПолученныеUVUTOCH_09
|			ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
|				DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования КАК ИдентификаторОснования
|			ИЗ
|				РегистрСведений.DR_События КАК DR_События
|			ГДЕ
|				DR_События.ВидДокумента = ""DP_PDOTPR_13""
|			
|			СГРУППИРОВАТЬ ПО
|				DR_События.ИдентификаторЦепочки,
|				DR_События.ИдентификаторОснования) КАК ПолученныеPDOTPR_13
|			ПО (ПолученныеUVUTOCH_09.ИдентификаторЦепочки = ПолученныеPDOTPR_13.ИдентификаторЦепочки)
|				И (ПолученныеPDOTPR_13.ИдентификаторОснования ПОДОБНО ""%"" + ПолученныеUVUTOCH_09.Идентификатор)
|		ПО (DR_События.ИдентификаторЦепочки = ПолученныеUVUTOCH_09.ИдентификаторЦепочки)
|			И (DR_События.Идентификатор = ПолученныеUVUTOCH_09.ИдентификаторОснования)
|ГДЕ
|	(DR_События.ВидДокумента = ""СчетФактура_Исходящий""
|				И ВложенныйЗапрос.АктуальныйДокумент
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPR_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Исходящий"")
|	И НЕ ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Корректировочный
|	И НЕ ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Исправление";
