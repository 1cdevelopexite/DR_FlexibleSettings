ТекстЗапроса = "ВЫБРАТЬ
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Номер КАК Номер,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Дата КАК Дата,
               |	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
               |	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
               |	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
               |	DR_События.Документ КАК Документ,
               |	ВложенныйЗапрос.АктуальныйДокумент КАК АктуальныйДокумент,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование КАК ДокументОснование,
               |	ВЫБОР
               |		КОГДА НЕ ПолученныеUVUTOCH_24.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОтклоненоАннулирование""
               |		КОГДА НЕ ОтправленныеUVUTOCH_24.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОтклоненоАннулирование""
               |		КОГДА НЕ ПолученныеIZVPOL_23.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПринятоАннулирование""
               |		КОГДА НЕ ОтправленныеIZVPOL_23.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПринятоАннулирование""
               |		КОГДА НЕ АннулированияПолученные.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПредложеноАннулирование""
               |		КОГДА НЕ АннулированияОтправленные.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОтправленоАннулирование""
               |		КОГДА НЕ ПолученныеUVUTOCH_09.Идентификатор ЕСТЬ NULL
               |				И НЕ ПолученныеPDOTPR_13.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ЗавершенСУточнением""
               |		КОГДА НЕ ПолученныеUVUTOCH_09.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""Уточнение_Получено""
               |		КОГДА НЕ ПолученныеIZVPOL_06.Идентификатор ЕСТЬ NULL
               |				И ЭКОМ_GLN.Контрагент_ФорматЭСФ В (""УПД Лента СЧФ"", ""УПД Метро"", ""УПД Зельгрос"", ""УПД Магнолия"", ""УПД ОКЕЙ"", ""УПД Спар"", ""УПД Дикси юг"", ""УПД Виктория"")
               |			ТОГДА ""ДокументооборотЗавершен""
               |		КОГДА НЕ ПолученныеПодписания.Идентификатор ЕСТЬ NULL
               |				И НЕ ОтправленныеIZVPOL_16.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ДокументооборотЗавершен""
               |		КОГДА НЕ ПолученныеПодписания.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПодписаноПокупателем""
               |		КОГДА НЕ ПолученныеIZVPOL_06.Идентификатор ЕСТЬ NULL
               |				ИЛИ НЕ ПолученныеPDOTPR_08.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОжиданиеПодтверждения""
               |		ИНАЧЕ ""Отправлен""
               |	КОНЕЦ КАК Статус_ЮЗД,
               |	DR_События.Сообщение КАК Сообщение,
               |	DR_События.ВидДокумента КАК ВидДокумента,
               |	DR_События.Идентификатор КАК Идентификатор,
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).НомерИсправления КАК НомерИсправления,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен КАК Проведен,
               |	ВЫБОР
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование.ПометкаУдаления
               |			ТОГДА 2
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ДокументОснование.Проведен
               |			ТОГДА 1
               |		ИНАЧЕ 0
               |	КОНЕЦ КАК ДокументОснование__КартинкаСтатус,
               |	ВЫБОР
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ПометкаУдаления
               |			ТОГДА 2
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен
               |			ТОГДА 1
               |		ИНАЧЕ 0
               |	КОНЕЦ КАК Документ__КартинкаСтатус
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
               |			МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи,
               |			DR_События.Документ КАК Документ,
               |			ИСТИНА КАК АктуальныйДокумент
               |		ИЗ
               |			РегистрСведений.DR_События КАК DR_События
               |		ГДЕ
               |			(DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Исходящий""
               |					ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Исходящий""
               |					ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRPROS_01_Исходящий"")
               |		
               |		СГРУППИРОВАТЬ ПО
               |			DR_События.Документ) КАК ВложенныйЗапрос
               |		ПО (DR_События.Документ = ВложенныйЗапрос.Документ)
               |			И (DR_События.ДатаЗаписи = ВложенныйЗапрос.ДатаЗаписи)
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
               |			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЭКОМ_GLN КАК ЭКОМ_GLN
               |			ПО (DR_ЦепочкиДокументов.Контрагент = ЭКОМ_GLN.Объект)
               |		ПО (DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки)
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК АннулированияОтправленные
               |		ПО (DR_События.ИдентификаторЦепочки = АннулированияОтправленные.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = АннулированияОтправленные.ИдентификаторОснования)
               |			И (АннулированияОтправленные.ВидДокумента = ""DP_PRANNUL_22_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК АннулированияПолученные
               |		ПО (DR_События.ИдентификаторЦепочки = АннулированияПолученные.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = АннулированияПолученные.ИдентификаторОснования)
               |			И (АннулированияПолученные.ВидДокумента = ""DP_PRANNUL_22_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеIZVPOL_16
               |		ПО (DR_События.ИдентификаторЦепочки = ОтправленныеIZVPOL_16.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ОтправленныеIZVPOL_16.Документ)
               |			И (ОтправленныеIZVPOL_16.ВидДокумента = ""DP_IZVPOL_16_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеIZVPOL_23
               |		ПО (DR_События.ИдентификаторЦепочки = ОтправленныеIZVPOL_23.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ОтправленныеIZVPOL_23.Документ)
               |			И (ОтправленныеIZVPOL_23.ВидДокумента = ""DP_IZVPOL_23_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеIZVPOL_23
               |		ПО (DR_События.ИдентификаторЦепочки = ПолученныеIZVPOL_23.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ПолученныеIZVPOL_23.Документ)
               |			И (ПолученныеIZVPOL_23.ВидДокумента = ""DP_IZVPOL_23_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеUVUTOCH_24
               |		ПО (DR_События.ИдентификаторЦепочки = ОтправленныеUVUTOCH_24.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ОтправленныеUVUTOCH_24.Документ)
               |			И (ОтправленныеUVUTOCH_24.ВидДокумента = ""DP_UVUTOCH_24_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеUVUTOCH_24
               |		ПО (DR_События.ИдентификаторЦепочки = ПолученныеUVUTOCH_24.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ПолученныеUVUTOCH_24.Документ)
               |			И (ПолученныеUVUTOCH_24.ВидДокумента = ""DP_UVUTOCH_24_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеUVUTOCH_09
               |		ПО (DR_События.ИдентификаторЦепочки = ПолученныеUVUTOCH_09.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ПолученныеUVUTOCH_09.Документ)
               |			И (ПолученныеUVUTOCH_09.ВидДокумента = ""DP_UVUTOCH_09_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеПодписания
               |		ПО (DR_События.ИдентификаторЦепочки = ПолученныеПодписания.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ПолученныеПодписания.ИдентификаторОснования)
               |			И (ПолученныеПодписания.ВидДокумента В (""ON_NSCHFDOPPOKMARK_11_Входящий"", ""ON_NSCHFDOPPOKPROS_11_Входящий"", ""ON_NSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOKMARK_11_Входящий"", ""ON_NKORSCHFDOPPOKPROS_11_Входящий""))
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеIZVPOL_06
               |		ПО (DR_События.ИдентификаторЦепочки = ПолученныеIZVPOL_06.ИдентификаторЦепочки)
               |			И (DR_События.Идентификатор = ПолученныеIZVPOL_06.ИдентификаторОснования)
               |			И (ПолученныеIZVPOL_06.ВидДокумента = ""DP_IZVPOL_06_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеPDOTPR_08
               |		ПО (DR_События.ИдентификаторЦепочки = ПолученныеPDOTPR_08.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ПолученныеPDOTPR_08.Документ)
               |			И (ПолученныеPDOTPR_08.ВидДокумента = ""DP_PDOTPR_08"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеPDOTPR_13
               |		ПО (DR_События.ИдентификаторЦепочки = ПолученныеPDOTPR_13.ИдентификаторЦепочки)
               |			И (DR_События.Документ = ПолученныеPDOTPR_13.Документ)
               |			И (ПолученныеPDOTPR_13.ВидДокумента = ""DP_PDOTPR_13"")
               |ГДЕ
               |	(DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Исходящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Исходящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRPROS_01_Исходящий"")";