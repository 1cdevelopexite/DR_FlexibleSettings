<ValueTree xmlns="http://v8.1c.ru/8.1/data/core" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="ValueTree">
	<column>
		<Name xsi:type="xs:string">Использовать</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">ТипТранзакции</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Кнопка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">СлужебныеТекст</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Сохранение</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Загрузка</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Служебные</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">КоллекцияТЧ</Name>
		<ValueType/>
	</column>
	<column>
		<Name xsi:type="xs:string">Данные</Name>
		<ValueType/>
	</column>
	<row>
		<Value xsi:type="xs:boolean">true</Value>
		<Value xsi:type="xs:string">Исходящий ON_NSCHFDOPPOK</Value>
		<Value xsi:type="xs:string">Подписать УПД/УКД</Value>
		<Value xsi:type="xs:string"/>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:decimal">0</Value>
		<Value xsi:type="xs:string">DR_ТекстЗапроса_ОтправкаПодписаниеСчетФактурOK = 
	"ВЫБРАТЬ
	|	ТаблицаМЧД.Организация КАК Организация,
	|	ТаблицаМЧД.Сертификат КАК Сертификат,
	|	ТаблицаМЧД.СертификатИНН КАК СертификатИНН,
	|	ТаблицаМЧД.СертификатНаСервере КАК СертификатНаСервере,
	|	ТаблицаМЧД.ДолжностьПодписанта КАК ДолжностьПодписанта,
	|	ТаблицаМЧД.ФамилияПодписанта КАК ФамилияПодписанта,
	|	ТаблицаМЧД.ИмяПодписанта КАК ИмяПодписанта,
	|	ТаблицаМЧД.ОтчествоПодписанта КАК ОтчествоПодписанта,
	|	ТаблицаМЧД.ОбластьПолномочий КАК ОбластьПолномочий,
	|	ТаблицаМЧД.ОснованиеПолномочий КАК ОснованиеПолномочий,
	|	ТаблицаМЧД.СтатусПодписанта КАК СтатусПодписанта,
	|	ТаблицаМЧД.СтрокаМЧД КАК СтрокаМЧД,
	|	ТаблицаМЧД.Организация_ПоддерживаетМЧД КАК Организация_ПоддерживаетМЧД,
	|	ТаблицаМЧД.ТипСертификата КАК ТипСертификата,
	|	ТаблицаМЧД.МЧД_Актуальна КАК МЧД_Актуальна
	|ПОМЕСТИТЬ ВТ_DR_МЧД
	|ИЗ
	|	&amp;ТаблицаМЧД КАК ТаблицаМЧД
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	DR_Документ.Ссылка КАК Документ_Основание,
	|	DR_Документ.ДанныеЭЦП КАК ДанныеЭЦП,
	|	Уточнения_События.ВидДокумента КАК ПроверкаНаУточнение,
	|	Подпись_События.ВидДокумента КАК ПроверкаНаПодпись,
	|	DR_Контрагент.Значение КАК Контрагент,
	|	DR_Организация.Значение КАК Организация,
	|	DR_ИдФайл.Значение КАК Идентификатор,
	|	ЮЗД_События.ВидДокумента КАК ВидДокументаЮЗД,
	|	ЮЗД_События.ДатаЗаписи КАК ДатаЗаписи,
	|	DR_ФайлНомер.Значение КАК ФайлНомер,
	|	DR_ФайлДата.Значение КАК ФайлДата,
	|	DR_ФайлНомерКор.Значение КАК ФайлНомерКор,
	|	DR_ФайлДатаКор.Значение КАК ФайлДатаКор,
	|	DR_ДатаИнфПр.Значение КАК ДатаИнфПр,
	|	DR_ВремИнфПр.Значение КАК ВремИнфПр,
	|	DR_Документ_ДатаИнфПр.Значение КАК Документ_ДатаИнфПр,
	|	DR_Документ_ВремИнфПр.Значение КАК Документ_ВремИнфПр,
	|	ВЫБОР
	|		КОГДА (ВЫРАЗИТЬ(DR_Документ.Комментарий КАК СТРОКА(100))) = """"
	|			ТОГДА 1
	|		ИНАЧЕ 2
	|	КОНЕЦ КАК КодИтога,
	|	ЮЗД_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки
	|ПОМЕСТИТЬ ВТ
	|ИЗ
	|	Документ.DR_Документ КАК DR_Документ
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_Контрагент
	|		ПО DR_Документ.Ссылка = DR_Контрагент.Ссылка
	|			И (DR_Контрагент.Реквизит = ""Контрагент"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_Организация
	|		ПО DR_Документ.Ссылка = DR_Организация.Ссылка
	|			И (DR_Организация.Реквизит = ""Организация"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ФайлНомер
	|		ПО DR_Документ.Ссылка = DR_ФайлНомер.Ссылка
	|			И (DR_ФайлНомер.Реквизит = ""Документ_СвСчФакт_НомерСчФ"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ФайлДата
	|		ПО DR_Документ.Ссылка = DR_ФайлДата.Ссылка
	|			И (DR_ФайлДата.Реквизит = ""Документ_СвСчФакт_ДатаСчФ"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ФайлНомерКор
	|		ПО (DR_Документ.Ссылка = DR_ФайлНомер.Ссылка)
	|			И (DR_ФайлНомер.Реквизит = ""Документ_СвКСчФ_НомерКСчФ"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ФайлДатаКор
	|		ПО (DR_Документ.Ссылка = DR_ФайлДата.Ссылка)
	|			И (DR_ФайлДата.Реквизит = ""Документ_СвКСчФ_ДатаКСчФ"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ЭтоПовторныйДокумент
	|		ПО DR_Документ.Ссылка = DR_ЭтоПовторныйДокумент.Ссылка
	|			И (DR_ЭтоПовторныйДокумент.Реквизит = ""ЭтоПовторныйДокумент"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_СтрокаBIN
	|		ПО DR_Документ.Ссылка = DR_СтрокаBIN.Ссылка
	|			И (DR_СтрокаBIN.Реквизит = ""СтрокаBIN"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ДатаИнфПр
	|		ПО DR_Документ.Ссылка = DR_ДатаИнфПр.Ссылка
	|			И (DR_ДатаИнфПр.Реквизит = ""ДатаИнфПр"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ВремИнфПр
	|		ПО DR_Документ.Ссылка = DR_ВремИнфПр.Ссылка
	|			И (DR_ВремИнфПр.Реквизит = ""ВремИнфПр"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_Документ_ДатаИнфПр
	|		ПО DR_Документ.Ссылка = DR_Документ_ДатаИнфПр.Ссылка
	|			И (DR_Документ_ДатаИнфПр.Реквизит = ""Документ_ДатаИнфПр"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_Документ_ВремИнфПр
	|		ПО DR_Документ.Ссылка = DR_Документ_ВремИнфПр.Ссылка
	|			И (DR_Документ_ВремИнфПр.Реквизит = ""Документ_ВремИнфПр"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.DR_Документ.ДополнительныеРеквизиты КАК DR_ИдФайл
	|		ПО DR_Документ.Ссылка = DR_ИдФайл.Ссылка
	|			И (DR_ИдФайл.Реквизит = ""ИдФайл"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК Подпись_События
	|		ПО DR_Документ.Ссылка = Подпись_События.Документ
	|			И (Подпись_События.ВидДокумента В (&amp;ВидыДокументовПодписиЮздИсходящие))
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК Уточнения_События
	|		ПО DR_Документ.Ссылка = Уточнения_События.Документ
	|			И (Уточнения_События.ВидДокумента = ""DP_UVUTOCH_09"")
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ЮЗД_События
	|		ПО DR_Документ.Ссылка = ЮЗД_События.Документ
	|			И (ЮЗД_События.ВидДокумента В (&amp;ВидыДокументовЮздВходящие))
	|ГДЕ
	|	DR_Документ.Статус = ""Обработан""
	|	И DR_Документ.Ссылка В(&amp;МассивДок)
	|	И ((ВЫРАЗИТЬ(DR_Документ.Комментарий КАК СТРОКА(100))) = """"
	|			ИЛИ DR_Документ.ВидДокумента = ""ON_NSCHFDOPPRMARK_01""
	|			ИЛИ DR_Документ.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Испр""
	|			ИЛИ DR_Документ.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01""
	|			ИЛИ DR_Документ.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Испр"")
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ВТ.Документ_Основание КАК ДокЭКОМ,
	|	ВТ.ДанныеЭЦП КАК ДанныеЭЦП,
	|	ВТ.ПроверкаНаУточнение КАК ПроверкаНаУточнение,
	|	ВТ.ПроверкаНаПодпись КАК ПроверкаНаПодпись,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.Сертификат
	|		ИНАЧЕ DR_GLN_Организация.Сертификат
	|	КОНЕЦ КАК Сертификат,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.СертификатНаСервере
	|		ИНАЧЕ DR_СертификатНаСервере.Значение
	|	КОНЕЦ КАК СертификатНаСервере,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.ДолжностьПодписанта
	|		ИНАЧЕ DR_ДолжностьПодписанта.Значение
	|	КОНЕЦ КАК ДолжностьПодписанта,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.ФамилияПодписанта
	|		ИНАЧЕ DR_ФамилияПодписанта.Значение
	|	КОНЕЦ КАК ФамилияПодписанта,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.ИмяПодписанта
	|		ИНАЧЕ DR_ИмяПодписанта.Значение
	|	КОНЕЦ КАК ИмяПодписанта,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.ОтчествоПодписанта
	|		ИНАЧЕ DR_ОтчествоПодписанта.Значение
	|	КОНЕЦ КАК ОтчествоПодписанта,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.ОбластьПолномочий
	|		ИНАЧЕ DR_ОбластьПолномочий.Значение
	|	КОНЕЦ КАК ОбластьПолномочий,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.ОснованиеПолномочий
	|		ИНАЧЕ DR_ОснованиеПолномочий.Значение
	|	КОНЕЦ КАК ОснованиеПолномочий,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.СтатусПодписанта
	|		ИНАЧЕ DR_СтатусПодписанта.Значение
	|	КОНЕЦ КАК СтатусПодписанта,
	|	ВТ.Организация КАК Организация,
	|	ВТ.Контрагент КАК Контрагент,
	|	DR_GLN_Организация.Партнер КАК ОператорОрганизации,
	|	ОператорОрганизацииИНН.Значение КАК ОператорОрганизацииИНН,
	|	ОператорОрганизацииИдентификатор.Значение КАК ОператорОрганизацииИдентификатор,
	|	DR_GLN_Организация.Ид_ОЭД КАК ИдентификаторОрганизации,
	|	DR_GLN_Контрагент.Партнер КАК ОператорКонтрагента,
	|	ОператорКонтрагентаИНН.Значение КАК ОператорКонтрагентаИНН,
	|	ОператорКонтрагентаИдентификатор.Значение КАК ОператорКонтрагентаИдентификатор,
	|	DR_GLN_Контрагент.Ид_ОЭД КАК ИдентификаторКонтрагента,
	|	ВТ.Идентификатор КАК Идентификатор,
	|	ВТ.ДатаЗаписи КАК ДатаЗаписи,
	|	ВТ.ВидДокументаЮЗД КАК ВидДокументаЮЗД,
	|	ВТ.ФайлНомер КАК ФайлНомер,
	|	ВТ.ФайлДата КАК ФайлДата,
	|	ВТ.ФайлНомерКор КАК ФайлНомерКор,
	|	ВТ.ФайлДатаКор КАК ФайлДатаКор,
	|	ВТ.ДатаИнфПр КАК ДатаИнфПр,
	|	ВТ.ВремИнфПр КАК ВремИнфПр,
	|	ВТ.Документ_ДатаИнфПр КАК Документ_ДатаИнфПр,
	|	ВТ.Документ_ВремИнфПр КАК Документ_ВремИнфПр,
	|	ВТ.КодИтога КАК КодИтога,
	|	ВТ.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
	|	DR_GLN_Контрагент.ПоддерживаетМЧД
	|		И DR_GLN_Организация.ПоддерживаетМЧД
	|		И DR_МЧД.ТипСертификата = 2 КАК ОтправитьМЧД,
	|	DR_МЧД.СтрокаМЧД КАК СтрокаМЧД,
	|	DR_МЧД.МЧД_Актуальна КАК МЧД_Актуальна,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|				И DR_МЧД.ТипСертификата = 2
	|			ТОГДА ""ФЛ""
	|		ИНАЧЕ ""ЮЛ""
	|	КОНЕЦ КАК ПодписантТип,
	|	ВЫБОР
	|		КОГДА DR_GLN_Организация.ПоддерживаетМЧД = ИСТИНА
	|				И DR_GLN_Контрагент.ПоддерживаетМЧД = ИСТИНА
	|			ТОГДА DR_МЧД.СертификатИНН
	|		ИНАЧЕ ВТ.Организация.ИНН
	|	КОНЕЦ КАК ПодписантИНН
	|ИЗ
	|	ВТ КАК ВТ
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_GLN КАК DR_GLN_Организация
	|		ПО ВТ.Организация = DR_GLN_Организация.Объект
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_СертификатНаСервере
	|		ПО (DR_GLN_Организация.Сертификат = DR_СертификатНаСервере.Ссылка)
	|			И (DR_СертификатНаСервере.Реквизит = ""СертификатНаСервере"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_ДолжностьПодписанта
	|		ПО (DR_GLN_Организация.Сертификат = DR_ДолжностьПодписанта.Ссылка)
	|			И (DR_ДолжностьПодписанта.Реквизит = ""ДолжностьПодписанта"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_ИмяПодписанта
	|		ПО (DR_GLN_Организация.Сертификат = DR_ИмяПодписанта.Ссылка)
	|			И (DR_ИмяПодписанта.Реквизит = ""ИмяПодписанта"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_ФамилияПодписанта
	|		ПО (DR_GLN_Организация.Сертификат = DR_ФамилияПодписанта.Ссылка)
	|			И (DR_ФамилияПодписанта.Реквизит = ""ФамилияПодписанта"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_ОтчествоПодписанта
	|		ПО (DR_GLN_Организация.Сертификат = DR_ОтчествоПодписанта.Ссылка)
	|			И (DR_ОтчествоПодписанта.Реквизит = ""ОтчествоПодписанта"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_ОбластьПолномочий
	|		ПО (DR_GLN_Организация.Сертификат = DR_ОбластьПолномочий.Ссылка)
	|			И (DR_ОбластьПолномочий.Реквизит = ""ОбластьПолномочий"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_ОснованиеПолномочий
	|		ПО (DR_GLN_Организация.Сертификат = DR_ОснованиеПолномочий.Ссылка)
	|			И (DR_ОснованиеПолномочий.Реквизит = ""ОснованиеПолномочий"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_СтатусПодписанта
	|		ПО (DR_GLN_Организация.Сертификат = DR_СтатусПодписанта.Ссылка)
	|			И (DR_СтатусПодписанта.Реквизит = ""СтатусПодписанта"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК ОператорОрганизацииИНН
	|		ПО (DR_GLN_Организация.Партнер = ОператорОрганизацииИНН.Ссылка)
	|			И (ОператорОрганизацииИНН.Реквизит = ""ИНН"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК ОператорОрганизацииИдентификатор
	|		ПО (DR_GLN_Организация.Партнер = ОператорОрганизацииИдентификатор.Ссылка)
	|			И (ОператорОрганизацииИдентификатор.Реквизит = ""Идентификатор"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_GLN КАК DR_GLN_Контрагент
	|		ПО ВТ.Контрагент = DR_GLN_Контрагент.Объект
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК ОператорКонтрагентаИНН
	|		ПО (DR_GLN_Контрагент.Партнер = ОператорКонтрагентаИНН.Ссылка)
	|			И (ОператорКонтрагентаИНН.Реквизит = ""ИНН"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки.ДополнительныеРеквизиты КАК ОператорКонтрагентаИдентификатор
	|		ПО (DR_GLN_Контрагент.Партнер = ОператорКонтрагентаИдентификатор.Ссылка)
	|			И (ОператорКонтрагентаИдентификатор.Реквизит = ""Идентификатор"")
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_DR_МЧД КАК DR_МЧД
	|		ПО ВТ.Организация = DR_МЧД.Организация
	|ГДЕ
	|	(ВТ.ПроверкаНаПодпись ЕСТЬ NULL
	|			ИЛИ ВТ.ПроверкаНаПодпись = НЕОПРЕДЕЛЕНО
	|			ИЛИ ВТ.ПроверкаНаПодпись = """")
	|	И (ВТ.ПроверкаНаУточнение ЕСТЬ NULL
	|			ИЛИ ВТ.ПроверкаНаУточнение = НЕОПРЕДЕЛЕНО
	|			ИЛИ ВТ.ПроверкаНаУточнение = """"
	|			ИЛИ ВТ.ВидДокументаЮЗД = ""ON_NSCHFDOPPRMARK_01""
	|			ИЛИ ВТ.ВидДокументаЮЗД = ""ON_NSCHFDOPPRMARK_01_Испр""
	|			ИЛИ ВТ.ВидДокументаЮЗД = ""ON_NKORSCHFDOPPRMARK_01""
	|			ИЛИ ВТ.ВидДокументаЮЗД = ""ON_NKORSCHFDOPPRMARK_01_Испр"")";
	
	///МЧД
	ЗапросМЧД = Новый Запрос;
	ЗапросМЧД.Текст = ТекстЗапроса_МЧД_ПоОрганизациям();
	ЗапросМЧД.УстановитьПараметр("ЭтоРегламентноеЗадание", ЭтоРегламентноеЗадание); 
	ЗапросМЧД.УстановитьПараметр("Пользователь", НайтиТекущегоПользователя()); 
	ЗапросМЧД.УстановитьПараметр("ТекущаяДата", ТекущаяДата()); 
	ТаблицаМЧД = ЗапросМЧД.Выполнить().Выгрузить();
	///
	
	ИмяСобытия = "Создание подписи ЮЗД";
	МассивСтруктурИсходящих   = Новый Массив;
	
	// Отбираем только обработанные документы ЭКОМ
	Запрос = Новый Запрос;
	Запрос.Текст = DR_ТекстЗапроса_ОтправкаПодписаниеСчетФактурOK;
	Запрос.УстановитьПараметр("ВидыДокументовЮздВходящие", Вычислить("DR_EDI_ОбщегоНазначения.ВидыДокументовВходящихЮЗД()"));
	Запрос.УстановитьПараметр("ВидыДокументовПодписиЮздИсходящие", Вычислить("DR_EDI_ОбщегоНазначения.ВидыДокументовИсходящихПодписейЮЗД()"));
	Запрос.УстановитьПараметр("ТаблицаМЧД", ТаблицаМЧД);
	
	// По регламенту
	Если Источник.Количество() = 0 Тогда
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "И DR_Документ.Ссылка В(&amp;МассивДок)", "");	
	Иначе
		// В ручную		
		Запрос.УстановитьПараметр("МассивДок", Источник);
	КонецЕсли;	
	
	РезультатЗапроса = Запрос.Выполнить();	
	
	ВременныйКаталог = ПутьВременногоКаталогаЭКОМ("SignPOK_out");
	КаталогВременный = ЭКОМ_СоздатьКаталогПроверитьНаЗапись(ВременныйКаталог, МассивЛогаСобытий);
	Если КаталогВременный = Неопределено Тогда
		ТекстЛогаСобытий = "Не удалось создать временный каталог, обработка была прервана.";
		ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Ошибка", ИмяСобытия);
		МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);		
		Перейти ~Выход;		
	КонецЕсли;
	
	СтруктураМетаДанных = ЮрФизЛицоОпределитьМетаданные();
	
	Если НЕ РезультатЗапроса.Пустой() Тогда
		Выборка = РезультатЗапроса.Выбрать();
		
		Пока Выборка.Следующий() Цикл 
			
			ЭЦП = Выборка.ДанныеЭЦП.Получить();
						
			Если Выборка.ОтправитьМЧД = Истина И (НЕ ЗначениеЗаполнено(Выборка.СтрокаМЧД) ИЛИ НЕ Выборка.МЧД_Актуальна) Тогда
				ТекстЛогаСобытий = "Не определена МЧД для текущего пользователя по организации! - " + Строка(Выборка.Организация);			
				ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Ошибка", ИмяСобытия);
				МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);
				
				Продолжить;
			КонецЕсли;
						
			Если НЕ ЗначениеЗаполнено(Выборка.Сертификат) Тогда
				ТекстЛогаСобытий = "Данные для организации не определены, заполните регистр ЭКОМ GLN! Возможно пользователя нет в списке.";
				ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Ошибка", ИмяСобытия);
				МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);
				
				Продолжить;
			КонецЕсли; 
			
			Если НЕ ЗначениеЗаполнено(Выборка.ОператорКонтрагента) Тогда
				ТекстЛогаСобытий = "Нет данных по контрагенту (регистр ЭКОМ GLN)! - " + Строка(Выборка.Контрагент);
				ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Ошибка", ИмяСобытия);
				МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);

				Продолжить;
			КонецЕсли;
			
			Если НЕ ЗначениеЗаполнено(Выборка.ОператорОрганизации) Тогда
				ТекстЛогаСобытий = "Нет данных по организации (регистр ЭКОМ GLN)! - " + Строка(Выборка.Организация);
				ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Ошибка", ИмяСобытия);
				МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);
			
				Продолжить;
			КонецЕсли;
			
			Если НЕ ЗначениеЗаполнено(Выборка.Идентификатор) Тогда
				ТекстЛогаСобытий = "Нет данных по документу (регистр ЭКОМ события)! - " + Строка(Выборка.ДокЭКОМ);
				ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Ошибка", ИмяСобытия);
				МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);

				Продолжить;
			КонецЕсли;
			
			Если НЕ ЗначениеЗаполнено(ЭЦП) Тогда	
				ТекстЛогаСобытий = "Не найдена ЭЦП для входящего ЮЗД документа ( не найдена запись в РС ""Docrobot События по документам"" документ: " + Выборка.ДокЭКОМ + ")";
				ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Ошибка", ИмяСобытия);
				МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);
				
				Продолжить;
			КонецЕсли; 

			СтруктураДокумента = Новый Структура;	
			СтруктураДокумента.Вставить("ВерсФорм", "5.01");
			СтруктураДокумента.Вставить("ВерсПрог", "Docrobot 1С Integration");	
			СтруктураДокумента.Вставить("НаимОргОператор"	, Выборка.ОператорОрганизации.Наименование);
			СтруктураДокумента.Вставить("ИННОператор"		, Выборка.ОператорОрганизацииИНН);
			СтруктураДокумента.Вставить("ИдЭДООператор"		, Выборка.ОператорОрганизацииИдентификатор);
			СтруктураДокумента.Вставить("ИдОтпр"	        , Выборка.ОператорОрганизацииИдентификатор + Выборка.ИдентификаторОрганизации); 
			СтруктураДокумента.Вставить("НаимОтрДок"	    , Выборка.ОператорКонтрагента.Наименование);
			СтруктураДокумента.Вставить("ИННОтрДок"		    , Выборка.ОператорКонтрагентаИНН);
			СтруктураДокумента.Вставить("ИдЭДООтрДок"	    , Выборка.ОператорКонтрагентаИдентификатор);
			СтруктураДокумента.Вставить("ИдПол"	            , Выборка.ОператорКонтрагентаИдентификатор + Выборка.ИдентификаторКонтрагента);			
			СтруктураДокумента.Вставить("ДатаИнфПок"		, Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy"));
			СтруктураДокумента.Вставить("ВремИнфПок"		, Формат(ТекущаяДата(), "ДФ=HH.mm.ss"));
			СтруктураДокумента.Вставить("НаимЭконСубСост"	, СокрЛП(Выборка.Организация.Наименование));
			СтруктураДокумента.Вставить("ОснДоверОргСост"	, "");
			СтруктураДокумента.Вставить("ИдФайлИнфПр"		, Выборка.Идентификатор);
			
			//ЭП
			СтруктураДокумента.Вставить("ЭЦППолФайл"	, ЭЦП);
			
			//СодФХЖ4
			СтруктураДокумента.Вставить("НаимДокОпрПр"	, "Счет-фактура и документ об отгрузке товаров (выполнении работ), передаче имущественных прав (документ об оказании услуг)");
			СтруктураДокумента.Вставить("ВидОперации"	, "Товар");
			
			//СвПрин
			СтруктураДокумента.Вставить("СодОпер"	, "Товары принял");
			СтруктураДокумента.Вставить("ДатаПрин"	, Формат(Выборка.ДатаЗаписи, "ДФ=dd.MM.yyyy"));
			СтруктураДокумента.Вставить("ДатаСоглас", Формат(Выборка.ДатаЗаписи, "ДФ=dd.MM.yyyy"));
			
			ПодписантДолжность = Выборка.ДолжностьПодписанта;
			ПодписантФамилия   = Выборка.ФамилияПодписанта;
			ПодписантИмя 	   = Выборка.ИмяПодписанта;
			ПодписантОтчество  = Выборка.ОтчествоПодписанта;	
			
			ЭтоЮрЛицоКонтрагент = ЮрФизЛицоОпределитьТипОбъекта(Выборка.Контрагент, СтруктураМетаДанных.ИмяРеквизитаКонтрагента, СтруктураМетаДанных.ПеречислениеЮрЛицо); 					
			Если ЭтоЮрЛицоКонтрагент Тогда
				СтруктураДокумента.Вставить("ТипОтправителя", "ЮЛ");
			Иначе 
				СтруктураДокумента.Вставить("ТипОтправителя", "ФЛ");
			КОнецЕсли;
			
			//РабОргПок
			СтруктураДокумента.Вставить("ОтпрДолжность"		, ПодписантДолжность);
			СтруктураДокумента.Вставить("ОтпрОснПолн"		, "");
			СтруктураДокумента.Вставить("ОтпрФамилия"		, ПодписантФамилия);
			СтруктураДокумента.Вставить("ОтпрИмя"			, ПодписантИмя);
			СтруктураДокумента.Вставить("ОтпрОтчество"		, "");
			
			//Подписанты
			//ОблПолн
			//1 - лицо, совершившее сделку, операцию; 
			//2 – лицо, совершившее сделку, операцию и ответственное за ее оформление;
			//3 – лицо, ответственное за оформление свершившегося события
			СтруктураДокумента.Вставить("лПодписантОблПолн"	, Выборка.ОбластьПолномочий);
			//Статус
			//1 - работник организации покупателя;
			//2 - работник организации – составителя информации покупателя;
			//3 - работник иной уполномоченной организации;
			//4 - уполномоченное физическое лицо, в том числе индивидуальный предприниматель
			ДатаФайлИнфПр = Дата(0001, 01, 01);
			ВремФайлИнфПр = "";
			
			КлючСтруктуры = "ТипДокумента, ВидДокументаПодписи";
			
			СоответствияВидов = Новый Соответствие;
			СоответствияВидов.Вставить("ON_NSCHFDOPPR_01_Входящий",           
			Новый Структура(КлючСтруктуры, "ON_NSCHFDOPPOK_11", "ON_NSCHFDOPPOK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NSCHFDOPPR_01_Испр_Входящий",   
			Новый Структура(КлючСтруктуры, "ON_NSCHFDOPPOK_11", "ON_NSCHFDOPPOK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NSCHFDOPPRMARK_01_Входящий",   
			Новый Структура(КлючСтруктуры, "ON_NSCHFDOPPOKMARK_11", "ON_NSCHFDOPPOKMARK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NSCHFDOPPRMARK_01_Испр_Входящий",   
			Новый Структура(КлючСтруктуры, "ON_NSCHFDOPPOKMARK_11", "ON_NSCHFDOPPOKMARK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NSCHFDOPPRPROS_01_Входящий",        
			Новый Структура(КлючСтруктуры, "ON_NSCHFDOPPOKPROS_11", "ON_NSCHFDOPPOKPROS_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NSCHFDOPPRPROS_01_Испр_Входящий",   
			Новый Структура(КлючСтруктуры, "ON_NSCHFDOPPOKPROS_11", "ON_NSCHFDOPPOKPROS_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_KORSCHFDOPPR_01",       
			Новый Структура(КлючСтруктуры, "ON_KORSCHFDOPPOK_11", "ON_KORSCHFDOPPOK_11")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_KORSCHFDOPPR_01_Испр",      
			Новый Структура(КлючСтруктуры, "ON_KORSCHFDOPPOK_11", "ON_KORSCHFDOPPOK_11")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NKORSCHFDOPPR_01_Входящий",     
			Новый Структура(КлючСтруктуры, "ON_NKORSCHFDOPPOK_11", "ON_NKORSCHFDOPPOK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NKORSCHFDOPPR_01_Испр_Входящий",     
			Новый Структура(КлючСтруктуры, "ON_NKORSCHFDOPPOK_11", "ON_NKORSCHFDOPPOK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NKORSCHFDOPPRMARK_01_Входящий",    
			Новый Структура(КлючСтруктуры, "ON_NKORSCHFDOPPOKMARK_11", "ON_NKORSCHFDOPPOKMARK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NKORSCHFDOPPRMARK_01_Испр_Входящий",
			Новый Структура(КлючСтруктуры, "ON_NKORSCHFDOPPOKMARK_11", "ON_NKORSCHFDOPPOKMARK_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
            СоответствияВидов.Вставить("ON_NKORSCHFDOPPRPROS_01_Входящий",    
			Новый Структура(КлючСтруктуры, "ON_NKORSCHFDOPPOKPROS_11", "ON_NKORSCHFDOPPOKPROS_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
			
			СоответствияВидов.Вставить("ON_NKORSCHFDOPPRPROS_01_Испр_Входящий", 
			Новый Структура(КлючСтруктуры, "ON_NKORSCHFDOPPOKPROS_11", "ON_NKORSCHFDOPPOKPROS_11_Исходящий")); //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]

			Данные = СоответствияВидов.Получить(Выборка.ВидДокументаЮЗД);
			ТипДокумента = Данные.ТипДокумента;
            ВидДокументаПодписи = Данные.ВидДокументаПодписи;
			
			Если ТипДокумента = "ON_KORSCHFDOPPOK_11" Тогда //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11] 
				
				ДатаФайлИнфПр = Выборка.ДатаИнфПр;
				ВремФайлИнфПр = Выборка.ВремИнфПр; 
									
				СтруктураДокумента.Вставить("КНД"		       , "1115128");
				СтруктураДокумента.Вставить("лПодписантСтатус" , Выборка.СтатусПодписанта);  
				
				ФайлНомер = СокрЛП(Выборка.ФайлНомерКор);		
				ФайлДата  = Формат(Выборка.ФайлДатаКор, "ДФ=dd.MM.yyyy");
				СЧФНомер  = СокрЛП(Выборка.ФайлНомерКор);
				СЧФДата   = Выборка.ФайлДатаКор;
				
			ИначеЕсли ТипДокумента = "ON_NSCHFDOPPOK_11"
				ИЛИ ТипДокумента = "ON_NSCHFDOPPOKMARK_11"
				ИЛИ ТипДокумента = "ON_NSCHFDOPPOKPROS_11" Тогда  //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
				
				Если Выборка.СтатусПодписанта = "1" Тогда
					ПодписантСтатус = "5";
				ИначеЕсли Выборка.СтатусПодписанта = "2" Тогда
					ПодписантСтатус = "6";	
				Иначе
					ПодписантСтатус = Выборка.СтатусПодписанта;
				КонецЕсли;
				
				СтруктураДокумента.Вставить("КодИтога"		  , Строка(Выборка.КодИтога));
				СтруктураДокумента.Вставить("КНД"		      , "1115132");
				СтруктураДокумента.Вставить("лПодписантСтатус", ПодписантСтатус);
				
				ФайлНомер = СокрЛП(Выборка.ФайлНомер);		
				ФайлДата  = Формат(Выборка.ФайлДата, "ДФ=dd.MM.yyyy");
				СЧФНомер  = СокрЛП(Выборка.ФайлНомер);
				СЧФДата   = Выборка.ФайлДата;
				
			ИначеЕсли ТипДокумента = "ON_NKORSCHFDOPPOK_11"
				ИЛИ ТипДокумента = "ON_NKORSCHFDOPPOKMARK_11"
				ИЛИ ТипДокумента = "ON_NKORSCHFDOPPOKPROS_11" Тогда //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
				
				Если Выборка.СтатусПодписанта = "1" Тогда
					ПодписантСтатус = "5";
				ИначеЕсли Выборка.СтатусПодписанта = "2" Тогда
					ПодписантСтатус = "6";	
				Иначе
					ПодписантСтатус = Выборка.СтатусПодписанта;
				КонецЕсли;
				
				СтруктураДокумента.Вставить("КНД"		      , "1115134");
				СтруктураДокумента.Вставить("лПодписантСтатус", ПодписантСтатус);			
				
				ФайлНомер = СокрЛП(Выборка.ФайлНомерКор);		
				ФайлДата  = Формат(Выборка.ФайлДатаКор, "ДФ=dd.MM.yyyy");
				СЧФНомер  = СокрЛП(Выборка.ФайлНомерКор);
				СЧФДата   = Выборка.ФайлДатаКор;
			КонецЕсли;
			
			Если ЗначениеЗаполнено(Выборка.Документ_ДатаИнфПр) Тогда
				ДатаФайлИнфПр = Выборка.Документ_ДатаИнфПр;
			КонецЕсли;
			
			Если ЗначениеЗаполнено(Выборка.Документ_ВремИнфПр) Тогда
				ВремФайлИнфПр = Выборка.Документ_ВремИнфПр;
			КонецЕсли; 
			
			СтруктураДокумента.Вставить("НомСчФИнфПр"	, ФайлНомер);		
			СтруктураДокумента.Вставить("ДатаСчФИнфПр"	, ФайлДата);
			
			СтруктураДокумента.Вставить("ДатаФайлИнфПр"    , Формат(ДатаФайлИнфПр, "ДФ=dd.MM.yyyy"));
			СтруктураДокумента.Вставить("ВремФайлИнфПр"    , ВремФайлИнфПр);
			СтруктураДокумента.Вставить("лПодписантОснПолн", Выборка.ОснованиеПолномочий);
			
			СтруктураДокумента.Вставить("ПодписантТип", Выборка.ПодписантТип); //"ЮЛ"		
			СтруктураДокумента.Вставить("ПодписантИНН", Выборка.ПодписантИНН); //Выборка.ДокЭКОМ.Организация.ИНН
			СтруктураДокумента.Вставить("ПодписантД"  , ПодписантДолжность);	
			СтруктураДокумента.Вставить("ПодписантФ"  , ПодписантФамилия);
			СтруктураДокумента.Вставить("ПодписантИ"  , ПодписантИмя);
			СтруктураДокумента.Вставить("ПодписантО"  , ПодписантОтчество);	
			СтруктураДокумента.Вставить("СчФ"         , Выборка.ДокЭКОМ);                                             	
						
			ТипДокументаБезНомера = Лев(ТипДокумента,СтрДлина(ТипДокумента)-3); //Docrobot 1.19.0 MOD-1377 [Получаем тип без номера квитанции _11]
						
			Идентификатор      = Новый УникальныйИдентификатор;
			ИдентификаторФайла = ТипДокументаБезНомера + "_" + СтруктураДокумента.ИдПол + "_" + СтруктураДокумента.ИдОтпр + "_" + Формат(ТекущаяДата(), "ДФ=yyyyMMdd") +"_"+ Идентификатор;	//Docrobot 1.19.0 MOD-1377 [Заменил ТипДокумента на ТипДокументаБезНомера]
	
			СтруктураДокумента.Вставить("ИдФайл"	  , ИдентификаторФайла);
			СтруктураДокумента.Вставить("ИмяПостФайла", Выборка.Идентификатор);
			
			ПредставлениеДок = "Счет-фактура № " + СЧФНомер + " от " + СЧФДата;
			
			ФайлXMLПолноеИмя = ВременныйКаталог + СтруктураДокумента.ИдФайл + ".xml";	
			
			Если ТипДокумента = "ON_SCHFDOPPOK_11"
				ИЛИ ТипДокумента = "ON_NSCHFDOPPOKMARK_11"
				ИЛИ ТипДокумента = "ON_NSCHFDOPPOKPROS_11"
				ИЛИ ТипДокумента = "ON_NSCHFDOPPOK_11" Тогда //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
				
				СтрокаXML = Записать_Файл_ЮЗД_Извешение_О_Получении(СтруктураДокумента, ФайлXMLПолноеИмя);
				
			ИначеЕсли ТипДокумента = "ON_KORSCHFDOPPOK_11"
				ИЛИ ТипДокумента = "ON_NKORSCHFDOPPOK_11"
				ИЛИ ТипДокумента = "ON_NKORSCHFDOPPOKMARK_11"
				ИЛИ ТипДокумента = "ON_NKORSCHFDOPPOKPROS_11" Тогда //Docrobot 1.19.0 MOD-1377 [Добавлен номер квитанции _11]
				
				Если СтруктураДокумента.Свойство("лПодписантОблПолн") Тогда
					СтруктураДокумента.лПодписантОблПолн = "3";
				КонецЕсли;
				
				СтрокаXML = Записать_Файл_УКД_Извешение_О_Получении(СтруктураДокумента, ФайлXMLПолноеИмя);
				
			КонецЕсли;
			
			СтруктураСтроки = Новый Структура;
			СтруктураСтроки.Вставить("ТипДокумента"         , ТипДокумента);
			СтруктураСтроки.Вставить("Документ"             , Выборка.ДокЭКОМ);
			СтруктураСтроки.Вставить("ИмяФайлаXML"          , СтруктураДокумента.ИдФайл + ".xml");
			СтруктураСтроки.Вставить("СтруктураДокумента"   , СтруктураДокумента);		
			СтруктураСтроки.Вставить("Статус"               , "Отправлен");
			СтруктураСтроки.Вставить("ВидДокумента"         , ВидДокументаПодписи);
			СтруктураСтроки.Вставить("ВидДокументаУПД"      , Выборка.ВидДокументаЮЗД);
			СтруктураСтроки.Вставить("ДанныеСертификатаЭКОМ", Выборка.Сертификат);
			СтруктураСтроки.Вставить("СертификатНаСервере"  , Выборка.СертификатНаСервере);
			СтруктураСтроки.Вставить("ПредставлениеДок"     , ПредставлениеДок);
			СтруктураСтроки.Вставить("Контрагент"           , Выборка.Контрагент);
			СтруктураСтроки.Вставить("Организация"          , Выборка.Организация);
			СтруктураСтроки.Вставить("ИдентификаторИспр"    , СтруктураДокумента.ИмяПостФайла);
			СтруктураСтроки.Вставить("СтрокаXML"            , СтрокаXML);
			СтруктураСтроки.Вставить("КодировкаФайла"       , "windows-1251");
			СтруктураСтроки.Вставить("НомерДокумента"       , ФайлНомер);
			СтруктураСтроки.Вставить("ДатаДокумента"        , ФайлДата);
			СтруктураСтроки.Вставить("ИдентификаторЦепочки" , Выборка.ИдентификаторЦепочки);
			СтруктураСтроки.Вставить("ИдентификаторОснования", Прав(Выборка.Идентификатор, 36));
			СтруктураСтроки.Вставить("Идентификатор"		, Идентификатор);
			
			СтруктураСтроки.Вставить("ТипФайла", СтрЗаменить(ТипДокумента, "_11", ""));
			Если Выборка.ОтправитьМЧД = Истина Тогда
				СтруктураСтроки.Вставить("СтрокаМЧД", СтрЗаменить(Выборка.СтрокаМЧД, "&amp;GUID", СтрЗаменить(Идентификатор, "-", "")));
			КонецЕсли;
			
			МассивСтруктурИсходящих.Добавить(СтруктураСтроки);
			
		КонецЦикла;
		
	Иначе		
		ТекстЛогаСобытий = "Нет документов для подписания. Возможно документ уже подписан или не обработан или по нему отправлено уточнение!";
		ЗаписьСтруктурыЛога = ЗаполненнаяЗаписьЛога(ТекстЛогаСобытий, "Предупреждение", ИмяСобытия);
		МассивЛогаСобытий.Добавить(ЗаписьСтруктурыЛога);
		
	КонецЕсли;
	~Выход:
	Возврат МассивСтруктурИсходящих;</Value>
		<Value xsi:type="ValueListType">
			<valueType/>
			<lastId xsi:type="xs:decimal">7</lastId>
			<item>
				<value xsi:type="xs:string">Прайс-лист</value>
				<id xsi:type="xs:decimal">0</id>
			</item>
			<item>
				<value xsi:type="xs:string">Поставщик</value>
				<id xsi:type="xs:decimal">1</id>
			</item>
			<item>
				<value xsi:type="xs:string">Покупатель</value>
				<presentation>СписокСчетаФактурыВходящиеПокупатель</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">2</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИмяКнопки</value>
				<presentation>Подписать УПД/УКД</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">3</id>
			</item>
			<item>
				<value xsi:type="xs:string">ПередаватьТекстПричины</value>
				<id xsi:type="xs:decimal">4</id>
			</item>
			<item>
				<value xsi:type="xs:string">ПриемникВидДокумента</value>
				<presentation>ON_NSCHFDOPPOK_11_Исходящий; ON_NSCHFDOPPOKPROS_11_Исходящий; ON_NSCHFDOPPOKMARK_11_Исходящий; ON_NKORSCHFDOPPOK_11_Исходящий; ON_NKORSCHFDOPPOKPROS_11_Исходящий; ON_NKORSCHFDOPPOKMARK_11_Исходящий</presentation>
				<id xsi:type="xs:decimal">5</id>
			</item>
			<item>
				<value xsi:type="xs:string">ИсточникВидДокумента</value>
				<presentation>ON_NSCHFDOPPR_01_Входящий; ON_NSCHFDOPPR_01_Испр_Входящий; ON_NSCHFDOPPRMARK_01_Входящий; ON_NSCHFDOPPRMARK_01_Испр_Входящий; ON_NSCHFDOPPRPROS_01_Входящий; ON_NSCHFDOPPRPROS_01_Испр_Входящий; ON_NKORSCHFDOPPR_01_Входящий; ON_NKORSCHFDOPPR_01_Испр_Входящий; ON_NKORSCHFDOPPRMARK_01_Входящий; ON_NKORSCHFDOPPRMARK_01_Испр_Входящий; ON_NKORSCHFDOPPRPROS_01_Входящий; ON_NKORSCHFDOPPRPROS_01_Испр_Входящий</presentation>
				<id xsi:type="xs:decimal">6</id>
			</item>
			<item>
				<value xsi:type="xs:string">НужнаПодпись</value>
				<presentation>Да</presentation>
				<checkState>1</checkState>
				<id xsi:type="xs:decimal">7</id>
			</item>
		</Value>
		<Value xsi:type="xs:string"/>
	</row>
</ValueTree>