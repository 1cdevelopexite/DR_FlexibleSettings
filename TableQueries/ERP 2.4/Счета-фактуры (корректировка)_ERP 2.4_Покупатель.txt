ТекстЗапроса = "ВЫБРАТЬ
               |	DR_НастройкиДополнительныеРеквизиты.Реквизит КАК Реквизит,
               |	ВЫРАЗИТЬ(DR_НастройкиДополнительныеРеквизиты.Значение КАК СТРОКА(250)) КАК Значение
               |ПОМЕСТИТЬ ВтВидыДокументов
               |ИЗ
               |	Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_НастройкиДополнительныеРеквизиты
               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки КАК DR_Настройки
               |		ПО (DR_НастройкиДополнительныеРеквизиты.Ссылка = DR_Настройки.Ссылка)
               |ГДЕ
               |	DR_Настройки.Наименование = ""ВидыДокументов""
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
               |	МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
               |ПОМЕСТИТЬ ВтАннулированияОтправленныеДата
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |ГДЕ
               |	DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий""
               |
               |СГРУППИРОВАТЬ ПО
               |	DR_События.ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования
               |
               |ИНДЕКСИРОВАТЬ ПО
               |	ИдентификаторЦепочки,
               |	ИдентификаторОснования
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
               |	МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
               |ПОМЕСТИТЬ ВтАннулированияПолученныеДата
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |ГДЕ
               |	DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий""
               |
               |СГРУППИРОВАТЬ ПО
               |	DR_События.ИдентификаторЦепочки,
               |	DR_События.ИдентификаторОснования
               |
               |ИНДЕКСИРОВАТЬ ПО
               |	ИдентификаторЦепочки,
               |	ИдентификаторОснования
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ РАЗЛИЧНЫЕ
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.DR_Документ).Номер КАК Номер,
               |	ВЫРАЗИТЬ(DR_События.Документ КАК Документ.DR_Документ).Дата КАК Дата,
               |	DR_События.Документ КАК Документ,
               |	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
               |	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
               |	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
               |	ВЫБОР
               |		КОГДА НЕ ПолученныеUVUTOCH_24.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОтклоненоАннулирование""
               |		КОГДА НЕ ОтправленныеUVUTOCH_24.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОтклоненоАннулирование""
               |		КОГДА НЕ ПолученныеIZVPOL_23.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПринятоАннулирование""
               |		КОГДА НЕ ОтправленныеIZVPOL_23.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПринятоАннулирование""
               |		КОГДА НЕ АннулированияОтправленные.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОтправленоАннулирование""
               |		КОГДА НЕ АннулированияПолученные.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПредложеноАннулирование""
               |		КОГДА НЕ ОтправленныеПодписания.Идентификатор ЕСТЬ NULL
               |				И НЕ ОтправленныеUVUTOCH_09.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ЗавершенСУточнением""
               |		КОГДА НЕ ОтправленныеПодписания.Идентификатор ЕСТЬ NULL
               |				И НЕ ПолученныеIZVPOL_16.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ДокументооборотЗавершен""
               |		КОГДА НЕ ОтправленныеПодписания.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ПодписаноПокупателем""
               |		КОГДА НЕ ОтправленныеUVUTOCH_09.Идентификатор ЕСТЬ NULL
               |				И НЕ ПолученныеPDOTPR_13.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ЗавершенСУточнением""
               |		КОГДА НЕ ОтправленныеUVUTOCH_09.Идентификатор ЕСТЬ NULL
               |			ТОГДА ""ОтправленоУточнение""
               |		КОГДА (ВЫРАЗИТЬ(ВЫРАЗИТЬ(DR_События.Документ КАК Документ.DR_Документ).Комментарий КАК СТРОКА(100))) <> """"
               |				И ВЫРАЗИТЬ(DR_События.Документ КАК Документ.DR_Документ).Статус = ""Обработан""
               |			ТОГДА ""Уточнение""
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.DR_Документ).Статус = ""Обработан""
               |			ТОГДА ""ТребуетсяПодписатьУПД""
               |		ИНАЧЕ ""НеОбработан""
               |	КОНЕЦ КАК СтатусЮЗД,
               |	DR_СобытияСЧФ.Документ КАК ДокументСЧФ,
               |	DR_События.Сообщение КАК Сообщение,
               |	ВтВидыДокументов.Значение КАК ВидДокумента,
               |	DR_События.Идентификатор КАК Идентификатор,
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	ВЫБОР
               |		КОГДА ВЫРАЗИТЬ(DR_СобытияСЧФ.Документ КАК Документ.СчетФактураПолученный).ПометкаУдаления
               |			ТОГДА 2
               |		КОГДА ВЫРАЗИТЬ(DR_СобытияСЧФ.Документ КАК Документ.СчетФактураПолученный).Проведен
               |			ТОГДА 1
               |		ИНАЧЕ 0
               |	КОНЕЦ КАК ДокументСЧФ__КартинкаСтатус
               |ПОМЕСТИТЬ ВтОсновная
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
               |		ПО DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВтВидыДокументов КАК ВтВидыДокументов
               |		ПО DR_События.ВидДокумента = ВтВидыДокументов.Реквизит
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВтАннулированияОтправленныеДата КАК ВтАннулированияОтправленныеДата
               |		ПО DR_События.ИдентификаторЦепочки = ВтАннулированияОтправленныеДата.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ВтАннулированияОтправленныеДата.ИдентификаторОснования
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК АннулированияОтправленные
               |		ПО DR_События.ИдентификаторЦепочки = АннулированияОтправленные.ИдентификаторЦепочки
               |			И (ВтАннулированияОтправленныеДата.ИдентификаторОснования = АннулированияОтправленные.ИдентификаторОснования)
               |			И (ВтАннулированияОтправленныеДата.ДатаЗаписи = АннулированияОтправленные.ДатаЗаписи)
               |			И (АннулированияОтправленные.ВидДокумента = ""DP_PRANNUL_22_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВтАннулированияПолученныеДата КАК ВтАннулированияПолученныеДата
               |		ПО DR_События.ИдентификаторЦепочки = ВтАннулированияПолученныеДата.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ВтАннулированияПолученныеДата.ИдентификаторОснования
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК АннулированияПолученные
               |		ПО DR_События.ИдентификаторЦепочки = АннулированияПолученные.ИдентификаторЦепочки
               |			И (ВтАннулированияПолученныеДата.ИдентификаторОснования = АннулированияПолученные.ИдентификаторОснования)
               |			И (ВтАннулированияПолученныеДата.ДатаЗаписи = АннулированияПолученные.ДатаЗаписи)
               |			И (АннулированияПолученные.ВидДокумента = ""DP_PRANNUL_22_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеIZVPOL_16
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеIZVPOL_16.ИдентификаторЦепочки
               |			И DR_События.Документ = ПолученныеIZVPOL_16.Документ
               |			И (ПолученныеIZVPOL_16.ВидДокумента = ""DP_IZVPOL_16_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеIZVPOL_23
               |		ПО DR_События.ИдентификаторЦепочки = ОтправленныеIZVPOL_23.ИдентификаторЦепочки
               |			И (АннулированияПолученные.Идентификатор = ОтправленныеIZVPOL_23.ИдентификаторОснования)
               |			И (ОтправленныеIZVPOL_23.ВидДокумента = ""DP_IZVPOL_23_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеIZVPOL_23
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеIZVPOL_23.ИдентификаторЦепочки
               |			И (АннулированияОтправленные.Идентификатор = ПолученныеIZVPOL_23.ИдентификаторОснования)
               |			И (ПолученныеIZVPOL_23.ВидДокумента = ""DP_IZVPOL_23_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеUVUTOCH_24
               |		ПО DR_События.ИдентификаторЦепочки = ОтправленныеUVUTOCH_24.ИдентификаторЦепочки
               |			И (АннулированияПолученные.Идентификатор = ОтправленныеUVUTOCH_24.ИдентификаторОснования)
               |			И (ОтправленныеUVUTOCH_24.ВидДокумента = ""DP_UVUTOCH_24_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеUVUTOCH_24
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеUVUTOCH_24.ИдентификаторЦепочки
               |			И (АннулированияОтправленные.Идентификатор = ПолученныеUVUTOCH_24.ИдентификаторОснования)
               |			И (ПолученныеUVUTOCH_24.ВидДокумента = ""DP_UVUTOCH_24_Входящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеUVUTOCH_09
               |		ПО DR_События.ИдентификаторЦепочки = ОтправленныеUVUTOCH_09.ИдентификаторЦепочки
               |			И DR_События.Документ = ОтправленныеUVUTOCH_09.Документ
               |			И (ОтправленныеUVUTOCH_09.ВидДокумента = ""DP_UVUTOCH_09_Исходящий"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ОтправленныеПодписания
               |		ПО DR_События.ИдентификаторЦепочки = ОтправленныеПодписания.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = ОтправленныеПодписания.ИдентификаторОснования
               |			И (ОтправленныеПодписания.ВидДокумента В (""ON_NSCHFDOPPOKMARK_11_Исходящий"", ""ON_NSCHFDOPPOKPROS_11_Исходящий"", ""ON_NSCHFDOPPOK_11_Исходящий"", ""ON_NKORSCHFDOPPOK_11_Исходящий"", ""ON_NKORSCHFDOPPOKMARK_11_Исходящий"", ""ON_NKORSCHFDOPPOKPROS_11_Исходящий""))
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК ПолученныеPDOTPR_13
               |		ПО DR_События.ИдентификаторЦепочки = ПолученныеPDOTPR_13.ИдентификаторЦепочки
               |			И DR_События.Документ = ПолученныеPDOTPR_13.Документ
               |			И (ПолученныеPDOTPR_13.ВидДокумента = ""DP_PDOTPR_13"")
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК DR_СобытияСЧФ
               |		ПО DR_События.ИдентификаторЦепочки = DR_СобытияСЧФ.ИдентификаторЦепочки
               |			И DR_События.Идентификатор = DR_СобытияСЧФ.ИдентификаторОснования
               |			И (DR_СобытияСЧФ.ВидДокумента = ""СчетФактура_Входящий"")
               |ГДЕ
               |	(DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Входящий""
               |			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRPROS_01_Входящий"")
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	ВтОсновная.Номер КАК Номер,
               |	ВтОсновная.Дата КАК Дата,
               |	ВтОсновная.Документ КАК Документ,
               |	ВтОсновная.ДатаЗаказа КАК ДатаЗаказа,
               |	ВтОсновная.НомерЗаказа КАК НомерЗаказа,
               |	ВтОсновная.ДатаПоставки КАК ДатаПоставки,
               |	ВтОсновная.СтатусЮЗД КАК СтатусЮЗД,
               |	ВтОсновная.ДокументСЧФ КАК ДокументСЧФ,
               |	ВтОсновная.Сообщение КАК Сообщение,
               |	ВтОсновная.ВидДокумента КАК ВидДокумента,
               |	ВтОсновная.Идентификатор КАК Идентификатор,
               |	ВтОсновная.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	ВтОсновная.ДокументСЧФ__КартинкаСтатус КАК ДокументСЧФ__КартинкаСтатус
               |ИЗ
               |	ВтОсновная КАК ВтОсновная";