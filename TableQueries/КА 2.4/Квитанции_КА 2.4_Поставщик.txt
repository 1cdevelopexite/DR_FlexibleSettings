ТекстЗапроса =  
"ВЫБРАТЬ
|	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|	DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|	МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
|ПОМЕСТИТЬ ВтАннулированияПолученныеДата
|ИЗ
|	РегистрСведений.DR_События КАК DR_События
|ГДЕ
|	DR_События.ВидДокумента = ""DP_PRANNUL_22_Входящий""
|
|СГРУППИРОВАТЬ ПО
|	DR_События.ИдентификаторЦепочки,
|	DR_События.ИдентификаторОснования
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
|	DR_События.ИдентификаторОснования КАК ИдентификаторОснования,
|	МАКСИМУМ(DR_События.ДатаЗаписи) КАК ДатаЗаписи
|ПОМЕСТИТЬ ВтАннулированияОтправленныеДата
|ИЗ
|	РегистрСведений.DR_События КАК DR_События
|ГДЕ
|	DR_События.ВидДокумента = ""DP_PRANNUL_22_Исходящий""
|
|СГРУППИРОВАТЬ ПО
|	DR_События.ИдентификаторЦепочки,
|	DR_События.ИдентификаторОснования
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ РАЗЛИЧНЫЕ
|	DR_События.Документ КАК Документ,
|	ВЫБОР
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).ПометкаУдаления
|			ТОГДА 2
|		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.СчетФактураВыданный).Проведен
|			ТОГДА 1
|		ИНАЧЕ 0
|	КОНЕЦ КАК Документ__КартинкаСтатус,
|	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
|	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
|	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
|	DR_События.ВидДокумента КАК ВидДокумента,
|	НЕ IZVPOL_06_Входящий.Идентификатор ЕСТЬ NULL КАК DP_IZVPOL_06_Входящий,
|	НЕ UVUTOCH_09_Входящий.Идентификатор ЕСТЬ NULL КАК DP_UVUTOCH_09_Входящий,
|	НЕ Запрос_11.Идентификатор ЕСТЬ NULL КАК ON_11,
|	НЕ IZVPOL_16_Исходящий.Идентификатор ЕСТЬ NULL КАК DP_PDOTPR_16,
|	НЕ PRANNUL_22_Входящий.Идентификатор ЕСТЬ NULL КАК DP_PRANNUL_22_Входящий,
|	НЕ PRANNUL_22_Исходящий.Идентификатор ЕСТЬ NULL КАК DP_PRANNUL_22_Исходящий,
|	НЕ IZVPOL_23_Входящий.Идентификатор ЕСТЬ NULL КАК DP_IZVPOL_23_Входящий,
|	НЕ IZVPOL_23_Исходящий.Идентификатор ЕСТЬ NULL КАК DP_IZVPOL_23_Исходящий,
|	НЕ UVUTOCH_24_Входящий.Идентификатор ЕСТЬ NULL КАК DP_UVUTOCH_24_Входящий,
|	НЕ UVUTOCH_24_Исходящий.Идентификатор ЕСТЬ NULL КАК DP_UVUTOCH_24_Исходящий,
|	UVUTOCH_09_Входящий.Сообщение КАК Текст_уведомления_09_Входящего,
|	DR_События.Идентификатор КАК Идентификатор,
|	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки
|ПОМЕСТИТЬ ВтОсновная
|ИЗ
|	РегистрСведений.DR_События КАК DR_События
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
|		ПО DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК IZVPOL_06_Входящий
|		ПО DR_События.ИдентификаторЦепочки = IZVPOL_06_Входящий.ИдентификаторЦепочки
|			И DR_События.Идентификатор = IZVPOL_06_Входящий.ИдентификаторОснования
|			И (IZVPOL_06_Входящий.ВидДокумента = ""DP_IZVPOL_06_Входящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК Запрос_11
|		ПО DR_События.ИдентификаторЦепочки = Запрос_11.ИдентификаторЦепочки
|			И DR_События.Идентификатор = Запрос_11.ИдентификаторОснования
|			И (Запрос_11.ВидДокумента В (""ON_NSCHFDOPPOKMARK_11_Входящий"", ""ON_NSCHFDOPPOKPROS_11_Входящий"", ""ON_NSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOK_11_Входящий"", ""ON_NKORSCHFDOPPOKMARK_11_Входящий"", ""ON_NKORSCHFDOPPOKPROS_11_Входящий""))
|		ЛЕВОЕ СОЕДИНЕНИЕ ВтАннулированияПолученныеДата КАК ВтАннулированияПолученныеДата
|		ПО DR_События.ИдентификаторЦепочки = ВтАннулированияПолученныеДата.ИдентификаторЦепочки
|			И DR_События.Идентификатор = ВтАннулированияПолученныеДата.ИдентификаторОснования
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК PRANNUL_22_Входящий
|		ПО DR_События.ИдентификаторЦепочки = PRANNUL_22_Входящий.ИдентификаторЦепочки
|			И DR_События.Идентификатор = PRANNUL_22_Входящий.ИдентификаторОснования
|			И (PRANNUL_22_Входящий.ВидДокумента = ""DP_PRANNUL_22_Входящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ ВтАннулированияОтправленныеДата КАК ВтАннулированияОтправленныеДата
|		ПО DR_События.ИдентификаторЦепочки = ВтАннулированияОтправленныеДата.ИдентификаторЦепочки
|			И DR_События.Идентификатор = ВтАннулированияОтправленныеДата.ИдентификаторОснования
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК PRANNUL_22_Исходящий
|		ПО DR_События.ИдентификаторЦепочки = PRANNUL_22_Исходящий.ИдентификаторЦепочки
|			И DR_События.ИдентификаторОснования = PRANNUL_22_Исходящий.ИдентификаторОснования
|			И (PRANNUL_22_Исходящий.ВидДокумента = ""DP_PRANNUL_22_Исходящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК UVUTOCH_09_Входящий
|		ПО DR_События.ИдентификаторЦепочки = UVUTOCH_09_Входящий.ИдентификаторЦепочки
|			И DR_События.Идентификатор = UVUTOCH_09_Входящий.ИдентификаторОснования
|			И (UVUTOCH_09_Входящий.ВидДокумента = ""DP_UVUTOCH_09_Входящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК IZVPOL_16_Исходящий
|		ПО DR_События.ИдентификаторЦепочки = IZVPOL_16_Исходящий.ИдентификаторЦепочки
|			И (Запрос_11.Идентификатор = IZVPOL_16_Исходящий.ИдентификаторОснования)
|			И (IZVPOL_16_Исходящий.ВидДокумента = ""DP_IZVPOL_16_Исходящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК IZVPOL_23_Исходящий
|		ПО DR_События.ИдентификаторЦепочки = IZVPOL_23_Исходящий.ИдентификаторЦепочки
|			И (PRANNUL_22_Входящий.Идентификатор = IZVPOL_23_Исходящий.ИдентификаторОснования)
|			И (IZVPOL_23_Исходящий.ВидДокумента = ""DP_IZVPOL_23_Исходящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК UVUTOCH_24_Исходящий
|		ПО DR_События.ИдентификаторЦепочки = UVUTOCH_24_Исходящий.ИдентификаторЦепочки
|			И (PRANNUL_22_Входящий.Идентификатор = UVUTOCH_24_Исходящий.ИдентификаторОснования)
|			И (UVUTOCH_24_Исходящий.ВидДокумента = ""DP_UVUTOCH_24_Исходящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК UVUTOCH_24_Входящий
|		ПО DR_События.ИдентификаторЦепочки = UVUTOCH_24_Входящий.ИдентификаторЦепочки
|			И (PRANNUL_22_Исходящий.Идентификатор = UVUTOCH_24_Входящий.ИдентификаторОснования)
|			И (UVUTOCH_24_Входящий.ВидДокумента = ""DP_UVUTOCH_24_Входящий"")
|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_События КАК IZVPOL_23_Входящий
|		ПО DR_События.ИдентификаторЦепочки = IZVPOL_23_Входящий.ИдентификаторЦепочки
|			И (PRANNUL_22_Исходящий.Идентификатор = IZVPOL_23_Входящий.ИдентификаторОснования)
|			И (IZVPOL_23_Входящий.ВидДокумента = ""DP_IZVPOL_23_Входящий"")
|ГДЕ
|	(DR_События.ВидДокумента = ""ON_NSCHFDOPPR_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRPROS_01_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRMARK_01_Испр_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NSCHFDOPPRPROS_01_Испр_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPR_01_Испр_Исходящий""
|			ИЛИ DR_События.ВидДокумента = ""ON_NKORSCHFDOPPRMARK_01_Испр_Исходящий"")
|
|ИНДЕКСИРОВАТЬ ПО
|	ИдентификаторЦепочки,
|	Идентификатор
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ
|	ВтОсновная.Документ КАК Документ,
|	ВтОсновная.Документ__КартинкаСтатус КАК Документ__КартинкаСтатус,
|	ВтОсновная.ДатаЗаказа КАК ДатаЗаказа,
|	ВтОсновная.НомерЗаказа КАК НомерЗаказа,
|	ВтОсновная.ДатаПоставки КАК ДатаПоставки,
|	ВтОсновная.ВидДокумента КАК ВидДокумента,
|	ВтОсновная.DP_IZVPOL_06_Входящий КАК DP_IZVPOL_06_Входящий,
|	ВтОсновная.DP_UVUTOCH_09_Входящий КАК DP_UVUTOCH_09_Входящий,
|	ВтОсновная.ON_11 КАК ON_11,
|	ВтОсновная.DP_PDOTPR_16 КАК DP_PDOTPR_16,
|	ВтОсновная.DP_PRANNUL_22_Входящий КАК DP_PRANNUL_22_Входящий,
|	ВтОсновная.DP_PRANNUL_22_Исходящий КАК DP_PRANNUL_22_Исходящий,
|	ВтОсновная.DP_IZVPOL_23_Входящий КАК DP_IZVPOL_23_Входящий,
|	ВтОсновная.DP_IZVPOL_23_Исходящий КАК DP_IZVPOL_23_Исходящий,
|	ВтОсновная.DP_UVUTOCH_24_Входящий КАК DP_UVUTOCH_24_Входящий,
|	ВтОсновная.DP_UVUTOCH_24_Исходящий КАК DP_UVUTOCH_24_Исходящий,
|	ВтОсновная.Текст_уведомления_09_Входящего КАК Текст_уведомления_09_Входящего,
|	ВтОсновная.Идентификатор КАК Идентификатор,
|	ВтОсновная.ИдентификаторЦепочки КАК ИдентификаторЦепочки
|ИЗ
|	ВтОсновная КАК ВтОсновная";