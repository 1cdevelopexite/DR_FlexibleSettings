ТекстЗапроса = "ВЫБРАТЬ
               |	DR_НастройкиДополнительныеРеквизиты.Реквизит КАК Реквизит,
               |	ВЫРАЗИТЬ(DR_НастройкиДополнительныеРеквизиты.Значение КАК СТРОКА(250)) КАК ВидДокумента
               |ПОМЕСТИТЬ ВтВидыДокументов
               |ИЗ
               |	Справочник.DR_Настройки.ДополнительныеРеквизиты КАК DR_НастройкиДополнительныеРеквизиты
               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.DR_Настройки КАК DR_Настройки
               |		ПО DR_НастройкиДополнительныеРеквизиты.Ссылка = DR_Настройки.Ссылка
               |ГДЕ
               |	DR_Настройки.Наименование = ""ВидыДокументов""
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	DR_События.Документ КАК Документ,
               |	DR_События.ВидДокумента КАК ВидДокумента,
               |	DR_ЦепочкиДокументов.ДатаЗаказа КАК ДатаЗаказа,
               |	DR_ЦепочкиДокументов.НомерЗаказа КАК НомерЗаказа,
               |	DR_ЦепочкиДокументов.ДатаПоставки КАК ДатаПоставки,
               |	DR_События.ДатаСообщения КАК ДатаСообщения,
               |	DR_События.Статус КАК Статус,
               |	DR_События.Сообщение КАК Сообщение,
               |	DR_События.ДатаЗаписи КАК ДатаЗаписи,
               |	DR_События.Идентификатор КАК Идентификатор,
               |	DR_События.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	ВЫБОР
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.ВозвратТоваровПоставщику).ПометкаУдаления
               |			ТОГДА 2
               |		КОГДА ВЫРАЗИТЬ(DR_События.Документ КАК Документ.ВозвратТоваровПоставщику).Проведен
               |			ТОГДА 1
               |		ИНАЧЕ 0
               |	КОНЕЦ КАК Документ__КартинкаСтатус
               |ПОМЕСТИТЬ ВтСобытияRETANN
               |ИЗ
               |	РегистрСведений.DR_События КАК DR_События
               |		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.DR_ЦепочкиДокументов КАК DR_ЦепочкиДокументов
               |		ПО DR_События.ИдентификаторЦепочки = DR_ЦепочкиДокументов.ИдентификаторЦепочки
               |		И РАЗНОСТЬДАТ(DR_ЦепочкиДокументов.ДатаЗаказа, DR_События.ДатаЗаписи, ДЕНЬ) МЕЖДУ 0 И &ПериодСвязиДокументов
               |ГДЕ
               |	DR_События.ВидДокумента = ""RETANN_Исходящий""
               |
               |ИНДЕКСИРОВАТЬ ПО
               |	ИдентификаторЦепочки,
               |	Идентификатор
               |;
               |
               |////////////////////////////////////////////////////////////////////////////////
               |ВЫБРАТЬ
               |	СобытияRETANN.Документ КАК Документ,
               |	ВидыДокументов.ВидДокумента КАК ВидДокумента,
               |	СобытияRETANN.ДатаЗаказа КАК ДатаЗаказа,
               |	СобытияRETANN.НомерЗаказа КАК НомерЗаказа,
               |	СобытияRETANN.ДатаПоставки КАК ДатаПоставки,
               |	СобытияRETANN.ДатаСообщения КАК ДатаСообщения,
               |	СобытияRETANN.Статус КАК Статус,
               |	СобытияRETANN.Сообщение КАК Сообщение,
               |	СобытияRETANN.ДатаЗаписи КАК ДатаЗаписи,
               |	СобытияRETANN.Идентификатор КАК Идентификатор,
               |	СобытияRETANN.ИдентификаторЦепочки КАК ИдентификаторЦепочки,
               |	СобытияRETANN.Документ__КартинкаСтатус КАК Документ__КартинкаСтатус
               |ИЗ
               |	ВтСобытияRETANN КАК СобытияRETANN
               |		ЛЕВОЕ СОЕДИНЕНИЕ ВтВидыДокументов КАК ВидыДокументов
               |		ПО СобытияRETANN.ВидДокумента = ВидыДокументов.Реквизит"